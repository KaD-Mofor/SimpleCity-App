{"version":3,"file":"BaseModel.js","sources":["../../../../../../src/v2/view-builder/internals/BaseModel.js"],"sourcesContent":["/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { _, Model } from '@okta/courage';\n\nconst convertUiSchemaFieldToProp = (uiSchemaField) => {\n  const config = Object.assign(\n    {},\n    _.chain(uiSchemaField)\n      .pick('minLength', 'maxLength', 'required', 'value')\n      .defaults({ type: 'string', required: true })\n      .value()\n  );\n\n  if (uiSchemaField.modelType) {\n    config.type = uiSchemaField.modelType;\n  }\n\n  return { [uiSchemaField.name]: config };\n};\n\nconst createPropsAndLocals = function(\n  remediation = {},\n  optionUiSchemaConfig = {},\n  props = {},\n  local = {}) {\n\n  const uiSchemas = remediation.uiSchema || [];\n\n  uiSchemas.forEach(schema => {\n    if (Array.isArray(schema.optionsUiSchemas)) {\n      let optionUiSchemaIndex;\n      let optionUiSchemaValue = {};\n\n      if (Number(schema.value) >= 0) {\n        optionUiSchemaIndex = schema.value;\n      }\n      if (optionUiSchemaConfig[schema.name]) {\n        optionUiSchemaValue = { value: optionUiSchemaConfig[schema.name] };\n        optionUiSchemaIndex = Number(optionUiSchemaValue.value);\n      }\n\n      Object.assign(\n        local,\n        convertUiSchemaFieldToProp(Object.assign({}, schema, optionUiSchemaValue)));\n\n      if (optionUiSchemaIndex) {\n        createPropsAndLocals(\n          { uiSchema: schema.optionsUiSchemas[optionUiSchemaIndex] },\n          optionUiSchemaConfig,\n          props,\n          local,\n        );\n      }\n    } else {\n      Object.assign(props, convertUiSchemaFieldToProp(schema));\n    }\n  });\n};\n\nconst create = function(remediation = {}, optionUiSchemaConfig = {}) {\n  const props = {};\n  const local = {\n    // current remediation form name\n    formName: 'string',\n    // use full page redirect instead of AJAX\n    useRedirect: 'boolean',\n  };\n  createPropsAndLocals(\n    remediation,\n    optionUiSchemaConfig,\n    props,\n    local);\n\n  const BaseModel = Model.extend({\n    props,\n    local,\n  });\n\n  return BaseModel;\n};\n\nexport default {\n  create,\n};\n"],"names":["convertUiSchemaFieldToProp","uiSchemaField","config","Object","assign","_","chain","pick","defaults","type","required","value","modelType","name","createPropsAndLocals","remediation","optionUiSchemaConfig","props","local","uiSchemas","uiSchema","forEach","schema","Array","isArray","optionsUiSchemas","optionUiSchemaIndex","optionUiSchemaValue","Number","create","formName","useRedirect","BaseModel","Model","extend"],"mappings":"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"}