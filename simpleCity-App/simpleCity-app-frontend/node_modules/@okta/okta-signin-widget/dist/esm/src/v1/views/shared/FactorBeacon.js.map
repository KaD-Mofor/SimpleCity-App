{"version":3,"file":"FactorBeacon.js","sources":["../../../../../../src/v1/views/shared/FactorBeacon.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint complexity: [2, 8] */\nimport { View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport Factor from 'v1/models/Factor';\nimport Q from 'q';\nimport FactorUtil from 'util/FactorUtil';\nimport FactorsDropDown from 'v1/views/mfa-verify/dropdown/FactorsDropDown';\nexport default View.extend({\n  template: hbs(\n    '\\\n      <div class=\"beacon-blank auth-beacon\">\\\n        <div class=\"beacon-blank js-blank-beacon-border auth-beacon-border\"></div>\\\n      </div>\\\n      <div class=\"bg-helper auth-beacon auth-beacon-factor {{className}}\" data-se=\"factor-beacon\">\\\n        <div class=\"okta-sign-in-beacon-border auth-beacon-border\"></div>\\\n      </div>\\\n      <div data-type=\"factor-types-dropdown\" class=\"factors-dropdown-wrap\"></div>\\\n    '\n  ),\n\n  events: {\n    'click .auth-beacon-factor': function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n      const expanded = this.$('.dropdown .options').toggle().is(':visible');\n\n      this.$('a.option-selected').attr('aria-expanded', expanded);\n      if (expanded) {\n        this.$('#okta-dropdown-options').find('li.factor-option:first a').focus();\n      }\n    },\n  },\n\n  initialize: function() {\n    this.options.appState.set('beaconType', 'factor');\n  },\n\n  getTemplateData: function() {\n    const factors = this.options.appState.get('factors');\n    let factor;\n    let className;\n\n    if (factors) {\n      factor = FactorUtil.findFactorInFactorsArray(factors, this.options.provider, this.options.factorType);\n    } else {\n      factor = new Factor.Model(this.options.appState.get('factor'));\n    }\n    className = factor.get('iconClassName');\n    return { className: className || '' };\n  },\n\n  postRender: function() {\n    if (this.options.animate) {\n      this.$('.auth-beacon-factor').fadeIn(200);\n    }\n    const appState = this.options.appState;\n\n    if (appState.get('hasMultipleFactorsAvailable')) {\n      this.add(FactorsDropDown, '[data-type=\"factor-types-dropdown\"]');\n    }\n  },\n\n  fadeOut: function() {\n    const deferred = Q.defer();\n\n    this.$('.auth-beacon-factor').fadeOut(200, function() {\n      deferred.resolve();\n    });\n    return deferred.promise;\n  },\n\n  equals: function(Beacon, options) {\n    return (\n      Beacon &&\n      this instanceof Beacon &&\n      options.provider === this.options.provider &&\n      (options.factorType === this.options.factorType ||\n        (FactorUtil.isOktaVerify(options.provider, options.factorType) &&\n          FactorUtil.isOktaVerify(this.options.provider, this.options.factorType)))\n    );\n  },\n});\n"],"names":["View","extend","template","events","e","preventDefault","stopPropagation","expanded","$","toggle","is","attr","find","focus","initialize","options","appState","set","getTemplateData","factors","get","factor","className","FactorUtil","findFactorInFactorsArray","provider","factorType","Factor","Model","postRender","animate","fadeIn","add","FactorsDropDown","fadeOut","deferred","Q","defer","resolve","promise","equals","Beacon","isOktaVerify"],"mappings":"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"}