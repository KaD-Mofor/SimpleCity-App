{"version":3,"file":"EnrollCustomFactorController.js","sources":["../../../../../src/v1/controllers/EnrollCustomFactorController.js"],"sourcesContent":["/*!\n * Copyright (c) 2018-2019, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, loc, internal } from '@okta/courage';\nimport FormController from 'v1/util/FormController';\nimport Footer from 'v1/views/enroll-factors/Footer';\nconst { Util } = internal.util;\nexport default FormController.extend({\n  className: 'enroll-custom-factor',\n  Model: {\n    local: {\n      provider: 'string',\n      factorType: 'string',\n    },\n    save: function() {\n      return this.manageTransaction((transaction, setTransaction) => {\n        const factor = _.findWhere(transaction.factors, {\n          provider: this.get('provider'),\n          factorType: this.get('factorType'),\n        });\n\n        return factor\n          .enroll()\n          .then(trans => {\n            setTransaction(trans);\n            const url = this.appState.get('enrollCustomFactorRedirectUrl');\n\n            if (url !== null) {\n              Util.redirect(url);\n            }\n          })\n          .catch(function(err) {\n            throw err;\n          });\n      });\n    },\n  },\n\n  Form: function() {\n    const factors = this.options.appState.get('factors');\n    const factor = factors.findWhere({\n      provider: this.options.provider,\n      factorType: this.options.factorType,\n    });\n    const vendorName = factor.get('vendorName');\n    const subtitle = loc('enroll.customFactor.subtitle', 'login', [vendorName]);\n    const saveText = loc('enroll.customFactor.save', 'login');\n\n    return {\n      autoSave: true,\n      title: vendorName,\n      subtitle: subtitle,\n      save: saveText,\n    };\n  },\n\n  trapAuthResponse: function() {\n    if (this.options.appState.get('isMfaEnrollActivate')) {\n      return true;\n    }\n  },\n\n  initialize: function() {\n    this.model.set('provider', this.options.provider);\n    this.model.set('factorType', this.options.factorType);\n  },\n\n  Footer: Footer,\n});\n"],"names":["Util","internal","util","FormController","extend","className","Model","local","provider","factorType","save","manageTransaction","transaction","setTransaction","factor","_","findWhere","factors","get","enroll","then","trans","url","appState","redirect","catch","err","Form","options","vendorName","subtitle","loc","saveText","autoSave","title","trapAuthResponse","initialize","model","set","Footer"],"mappings":"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"}