{"version":3,"file":"BaseView.js","sources":["../../../../../../src/v2/view-builder/internals/BaseView.js"],"sourcesContent":["import { _, View } from '@okta/courage';\nimport BaseHeader from './BaseHeader';\nimport BaseForm from './BaseForm';\nimport BaseModel from './BaseModel';\nimport BaseFooter from './BaseFooter';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport {getClassNameMapping} from '../../ion/ViewClassNamesFactory';\n\nexport default View.extend({\n\n  Header: BaseHeader,\n\n  Body: BaseForm,\n\n  Footer: BaseFooter,\n\n  className() {\n    const appState = this.options.appState;\n\n    const formName = appState.get('currentFormName');\n    const authenticatorKey = appState.get('authenticatorKey');\n    const methodType = appState.get('authenticatorMethodType');\n    const isPasswordRecoveryFlow = appState.get('isPasswordRecoveryFlow');\n\n    const additionalClassNames = getClassNameMapping(\n      formName,\n      authenticatorKey,\n      methodType,\n      isPasswordRecoveryFlow,\n    );\n\n    const classNames = ['siw-main-view'].concat(additionalClassNames);\n    return classNames.join(' ');\n  },\n\n  template: hbs`\n    <div class=\"siw-main-header\"></div>\n    <div class=\"siw-main-body\"></div>\n    <div class=\"siw-main-footer\"></div>\n  `,\n\n  preRender() {\n    View.prototype.preRender.apply(this, arguments);\n    // Add Views\n    if (this.Header !== null) {\n      this.add(this.Header, {\n        selector: '.siw-main-header',\n        options: this.options,\n      });\n    }\n    this.renderForm();\n    this.add(this.Footer, {\n      selector : '.siw-main-footer',\n      options: this.options,\n    });\n  },\n\n  renderForm() {\n    let optionUiSchemaConfig;\n\n    if (this.form) {\n      this.form.remove();\n      optionUiSchemaConfig = this.form.model.toJSON({verbose: true});\n    }\n\n    // Create Model\n    const IonModel = this.createModelClass(\n      this.options.currentViewState,\n      optionUiSchemaConfig,\n      this.settings,\n    );\n\n    const model = new IonModel ({\n      formName: this.options.currentViewState.name,\n    });\n\n    if (!optionUiSchemaConfig) {\n      optionUiSchemaConfig = model.toJSON({verbose: true});\n    }\n\n    this.model = model;\n    this.form = this.add(this.Body, {\n      selector : '.siw-main-body',\n      options: Object.assign(\n        {},\n        this.options,\n        {\n          model,\n          optionUiSchemaConfig,\n        },\n      ),\n    }).last();\n\n    _.each(model.attributes, (value, key) => {\n      if (key.match(/sub_schema_local_[^ ]+/)) {\n        // in order to render different sub-schema\n        this.listenTo(model, `change:${key}`, () => {\n          this.renderForm();\n        });\n      }\n    });\n  },\n\n  createModelClass(currentViewState, optionUiSchemaConfig = {}) {\n    return BaseModel.create(currentViewState, optionUiSchemaConfig);\n  },\n\n});\n"],"names":["View","extend","Header","BaseHeader","Body","BaseForm","Footer","BaseFooter","className","appState","options","formName","get","authenticatorKey","methodType","isPasswordRecoveryFlow","additionalClassNames","getClassNameMapping","classNames","concat","join","template","preRender","prototype","apply","arguments","add","selector","renderForm","optionUiSchemaConfig","form","remove","model","toJSON","verbose","IonModel","createModelClass","currentViewState","settings","name","Object","assign","last","_","each","attributes","value","key","match","listenTo","BaseModel","create"],"mappings":"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"}