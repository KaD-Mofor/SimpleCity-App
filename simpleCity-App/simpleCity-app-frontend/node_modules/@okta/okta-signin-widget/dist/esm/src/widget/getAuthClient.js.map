{"version":3,"file":"getAuthClient.js","sources":["../../../../src/widget/getAuthClient.ts"],"sourcesContent":["import { ConfigError } from 'util/Errors';\nimport Util from 'util/Util';\nimport config from 'config/config.json';\nimport { WidgetOptions, WidgetOktaAuthConstructor, WidgetOktaAuthInterface } from 'types';\n\nexport default function getAuthClientInstance(\n  OktaAuth: WidgetOktaAuthConstructor,\n  options: WidgetOptions = {}\n): WidgetOktaAuthInterface\n{\n  // if authClient is set, authParams are disregarded\n  let { authClient, authParams } = options;\n\n  if (!authClient) {\n    // Create an authClient using widget options and optional authParams\n    const {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      recoveryToken\n    } = options;\n    authParams = {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      transformErrorXHR: Util.transformErrorXHR,\n      recoveryToken,\n      ...authParams\n    };\n\n    if (!authParams.issuer) {\n      authParams.issuer = options.baseUrl + '/oauth2/default';\n    }\n\n    authClient = new OktaAuth(authParams);\n  }\n\n  // Add widget version to extended user agent header\n  if (!authClient._oktaUserAgent) {\n    throw new ConfigError('The passed in authClient should be version 5.4.0 or above.');\n  } else {\n    authClient._oktaUserAgent.addEnvironment(`okta-signin-widget-${config.version}`);\n  }\n\n  return authClient;\n}\n"],"names":["getAuthClientInstance","OktaAuth","options","authClient","authParams","issuer","clientId","redirectUri","state","scopes","flow","codeChallenge","codeChallengeMethod","recoveryToken","transformErrorXHR","Util","baseUrl","_oktaUserAgent","ConfigError","addEnvironment","config","version"],"mappings":";;;;AAKe,SAASA,qBAAqB,CAC3CC,QAAmC,EACnCC,OAAsB,GAAG,EAAE,EAE7B;AACE;EACA,IAAI;AAAEC,IAAAA,UAAU,EAAVA,UAAU;AAAEC,IAAAA,UAAU,EAAVA,UAAAA;AAAW,GAAC,GAAGF,OAAO,CAAA;EAExC,IAAI,CAACC,UAAU,EAAE;AACf;IACA,MAAM;AACJE,MAAAA,MAAM,EAANA,MAAM;AACNC,MAAAA,QAAQ,EAARA,QAAQ;AACRC,MAAAA,WAAW,EAAXA,WAAW;AACXC,MAAAA,KAAK,EAALA,KAAK;AACLC,MAAAA,MAAM,EAANA,MAAM;AACNC,MAAAA,IAAI,EAAJA,IAAI;AACJC,MAAAA,aAAa,EAAbA,aAAa;AACbC,MAAAA,mBAAmB,EAAnBA,mBAAmB;AACnBC,MAAAA,aAAa,EAAbA,aAAAA;AACF,KAAC,GAAGX,OAAO,CAAA;AACXE,IAAAA,UAAU,GAAG;AACXC,MAAAA,MAAM,EAANA,MAAM;AACNC,MAAAA,QAAQ,EAARA,QAAQ;AACRC,MAAAA,WAAW,EAAXA,WAAW;AACXC,MAAAA,KAAK,EAALA,KAAK;AACLC,MAAAA,MAAM,EAANA,MAAM;AACNC,MAAAA,IAAI,EAAJA,IAAI;AACJC,MAAAA,aAAa,EAAbA,aAAa;AACbC,MAAAA,mBAAmB,EAAnBA,mBAAmB;MACnBE,iBAAiB,EAAEC,IAAI,CAACD,iBAAiB;AACzCD,MAAAA,aAAa,EAAbA,aAAa;MACb,GAAGT,UAAAA;KACJ,CAAA;AAED,IAAA,IAAI,CAACA,UAAU,CAACC,MAAM,EAAE;AACtBD,MAAAA,UAAU,CAACC,MAAM,GAAGH,OAAO,CAACc,OAAO,GAAG,iBAAiB,CAAA;AACzD,KAAA;AAEAb,IAAAA,UAAU,GAAG,IAAIF,QAAQ,CAACG,UAAU,CAAC,CAAA;AACvC,GAAA;;AAEA;AACA,EAAA,IAAI,CAACD,UAAU,CAACc,cAAc,EAAE;AAC9B,IAAA,MAAM,IAAIC,WAAW,CAAC,4DAA4D,CAAC,CAAA;AACrF,GAAC,MAAM;IACLf,UAAU,CAACc,cAAc,CAACE,cAAc,CAAE,sBAAqBC,MAAM,CAACC,OAAQ,CAAA,CAAC,CAAC,CAAA;AAClF,GAAA;AAEA,EAAA,OAAOlB,UAAU,CAAA;AACnB;;;;"}