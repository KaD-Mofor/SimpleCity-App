{"version":3,"file":"ChallengePIVView.js","sources":["../../../../../../../src/v2/view-builder/views/piv/ChallengePIVView.js"],"sourcesContent":["import { loc } from '@okta/courage';\nimport { BaseForm } from '../../internals';\nimport BaseAuthenticatorView from '../../components/BaseAuthenticatorView';\nimport PIVHeader from './PIVHeader';\n\nconst Body = BaseForm.extend({\n\n  className: 'piv-cac-card',\n  modelEvents: {\n    request: 'startAuthentication',\n    error: 'stopAuthentication',\n  },\n\n  initialize() {\n    BaseForm.prototype.initialize.apply(this, arguments);\n    this.model.set('useRedirect', true);\n    this.addInstructions();\n  },\n\n  title() {\n    return loc('piv.cac.title', 'login');\n  },\n\n  save() {\n    return loc('retry', 'login');\n  },\n\n  addInstructions() {\n    this.add(\n      `<div class='piv-verify-text'>\n        <p>${loc('piv.cac.card.insert', 'login')}</p>\n        <div data-se='piv-waiting' class='okta-waiting-spinner'></div>\n      </div>`\n    );\n  },\n  \n  startAuthentication: function() {\n    this.$('.okta-waiting-spinner').show();\n    this.$('.o-form-button-bar').hide();\n  },\n\n  stopAuthentication: function() {\n    this.$('.okta-waiting-spinner').hide();\n    this.$('.o-form-button-bar').show();\n  }\n  \n});\n\nexport default BaseAuthenticatorView.extend({\n  Header: PIVHeader,\n  Body,\n  postRender() {\n    BaseAuthenticatorView.prototype.postRender.apply(this, arguments);\n    const messages = this.options.appState.get('messages') || {};\n    // if piv view has errors, show errors and stop authentication.\n    // otherwise trigger authentication on page load\n    if (Array.isArray(messages.value)) {\n      this.form.stopAuthentication();\n    } else {\n      this.form.startAuthentication();\n      this.form.trigger('save', this.model);\n    }\n  },\n});\n"],"names":["Body","BaseForm","extend","className","modelEvents","request","error","initialize","prototype","apply","arguments","model","set","addInstructions","title","loc","save","add","startAuthentication","$","show","hide","stopAuthentication","BaseAuthenticatorView","Header","PIVHeader","postRender","messages","options","appState","get","Array","isArray","value","form","trigger"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,MAAMA,IAAI,GAAGC,QAAQ,CAACC,MAAM,CAAC;AAE3BC,EAAAA,SAAS,EAAE,cAAc;AACzBC,EAAAA,WAAW,EAAE;AACXC,IAAAA,OAAO,EAAE,qBAAqB;AAC9BC,IAAAA,KAAK,EAAE,oBAAA;GACR;AAEDC,EAAAA,UAAU,EAAG,YAAA;IACXN,QAAQ,CAACO,SAAS,CAACD,UAAU,CAACE,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC,CAAA;IACpD,IAAI,CAACC,KAAK,CAACC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,CAAA;IACnC,IAAI,CAACC,eAAe,EAAE,CAAA;GACvB;AAEDC,EAAAA,KAAK,EAAG,YAAA;AACN,IAAA,OAAOC,GAAG,CAAC,eAAe,EAAE,OAAO,CAAC,CAAA;GACrC;AAEDC,EAAAA,IAAI,EAAG,YAAA;AACL,IAAA,OAAOD,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;GAC7B;AAEDF,EAAAA,eAAe,EAAG,YAAA;IAChB,IAAI,CAACI,GAAG,CACL,CAAA;AACP,WAAA,EAAaF,GAAG,CAAC,qBAAqB,EAAE,OAAO,CAAE,CAAA;AACjD;AACA,YAAA,CAAa,CACR,CAAA;GACF;AAEDG,EAAAA,mBAAmB,EAAE,YAAW;AAC9B,IAAA,IAAI,CAACC,CAAC,CAAC,uBAAuB,CAAC,CAACC,IAAI,EAAE,CAAA;AACtC,IAAA,IAAI,CAACD,CAAC,CAAC,oBAAoB,CAAC,CAACE,IAAI,EAAE,CAAA;GACpC;AAEDC,EAAAA,kBAAkB,EAAE,YAAW;AAC7B,IAAA,IAAI,CAACH,CAAC,CAAC,uBAAuB,CAAC,CAACE,IAAI,EAAE,CAAA;AACtC,IAAA,IAAI,CAACF,CAAC,CAAC,oBAAoB,CAAC,CAACC,IAAI,EAAE,CAAA;AACrC,GAAA;AAEF,CAAC,CAAC,CAAA;AAEF,uBAAeG,qBAAqB,CAACrB,MAAM,CAAC;AAC1CsB,EAAAA,MAAM,EAAEC,SAAS;AACjBzB,EAAAA,IAAI,EAAJA,IAAI;AACJ0B,EAAAA,UAAU,EAAG,YAAA;IACXH,qBAAqB,CAACf,SAAS,CAACkB,UAAU,CAACjB,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC,CAAA;AACjE,IAAA,MAAMiB,QAAQ,GAAG,IAAI,CAACC,OAAO,CAACC,QAAQ,CAACC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,CAAA;AAC5D;AACA;IACA,IAAIC,KAAK,CAACC,OAAO,CAACL,QAAQ,CAACM,KAAK,CAAC,EAAE;AACjC,MAAA,IAAI,CAACC,IAAI,CAACZ,kBAAkB,EAAE,CAAA;AAChC,KAAC,MAAM;AACL,MAAA,IAAI,CAACY,IAAI,CAAChB,mBAAmB,EAAE,CAAA;MAC/B,IAAI,CAACgB,IAAI,CAACC,OAAO,CAAC,MAAM,EAAE,IAAI,CAACxB,KAAK,CAAC,CAAA;AACvC,KAAA;AACF,GAAA;AACF,CAAC,CAAC;;;;"}