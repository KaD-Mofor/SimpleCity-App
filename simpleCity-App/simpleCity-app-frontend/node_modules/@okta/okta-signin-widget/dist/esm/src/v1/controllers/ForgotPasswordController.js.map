{"version":3,"file":"ForgotPasswordController.js","sources":["../../../../../src/v1/controllers/ForgotPasswordController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, loc, View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport Enums from 'util/Enums';\nimport FormController from 'v1/util/FormController';\nimport FormType from 'v1/util/FormType';\nimport Util from 'util/Util';\nimport ValidationUtil from 'v1/util/ValidationUtil';\nimport ContactSupport from 'v1/views/shared/ContactSupport';\nimport TextBox from 'v1/views/shared/TextBox';\nconst ForgotPasswordControllernoFactorsError = View.extend({\n  template: hbs`\n      <div class=\"okta-form-infobox-error infobox infobox-error\" role=\"alert\">\n        <span class=\"icon error-16\"></span>\n        <p>{{i18n code=\"password.forgot.noFactorsEnabled\" bundle=\"login\"}}</p>\n      </div>\n    `,\n});\nconst ForgotPasswordControllerFooter = View.extend({\n  template: hbs(\n    '\\\n      {{#unless hideBackToSignInForReset}}\\\n        <a href=\"#\" class=\"link help js-back\" data-se=\"back-link\">\\\n          {{i18n code=\"goback\" bundle=\"login\"}}\\\n        </a>\\\n      {{/unless}}\\\n      {{#if helpSupportNumber}}\\\n      <a href=\"#\" class=\"link goto js-contact-support\">\\\n        {{i18n code=\"mfa.noAccessToEmail\" bundle=\"login\"}}\\\n      </a>\\\n      {{/if}}\\\n    '\n  ),\n  className: 'auth-footer',\n  events: {\n    'click .js-back': function(e) {\n      e.preventDefault();\n      this.back();\n    },\n    'click .js-contact-support': function(e) {\n      e.preventDefault();\n      this.state.trigger('contactSupport');\n      this.$('.js-contact-support').hide();\n    },\n  },\n  getTemplateData: function() {\n    return {\n      hideBackToSignInForReset: this.settings.get('features.hideBackToSignInForReset'),\n      helpSupportNumber: this.settings.get('helpSupportNumber'),\n    };\n  },\n  back: function() {\n    this.state.set('navigateDir', Enums.DIRECTION_BACK);\n    this.options.appState.trigger('navigate', '');\n  },\n});\nexport default FormController.extend({\n  className: 'forgot-password',\n  Model: {\n    props: {\n      username: ['string', true],\n      factorType: ['string', true],\n    },\n    validate: function() {\n      return ValidationUtil.validateUsername(this);\n    },\n    save: function() {\n      const self = this;\n      const relayState = this.settings.get('relayState');\n\n      this.startTransaction(function(authClient) {\n        return authClient.forgotPassword({\n          username: self.settings.transformUsername(self.get('username'), Enums.FORGOT_PASSWORD),\n          factorType: self.get('factorType'),\n          relayState: relayState,\n        });\n      }).catch(function() {\n        //need empty fail handler on model to display errors on form\n      });\n    },\n  },\n  Form: {\n    noButtonBar: true,\n    title: _.partial(loc, 'password.reset', 'login'),\n    formChildren: function() {\n      const smsEnabled = this.settings.get('features.smsRecovery');\n      /*eslint complexity: [2, 9] max-statements: [2, 23] */\n\n      const callEnabled = this.settings.get('features.callRecovery');\n      const emailEnabled = this.settings.get('features.emailRecovery');\n      const noFactorsEnabled = !(smsEnabled || callEnabled || emailEnabled);\n      const formChildren = [];\n\n      if (noFactorsEnabled) {\n        this.add(ForgotPasswordControllernoFactorsError, '.o-form-error-container');\n      } else {\n        formChildren.push(\n          FormType.Input({\n            label: loc('password.forgot.email.or.username.placeholder', 'login'),\n            'label-top': true,\n            explain: Util.createInputExplain(\n              'password.forgot.email.or.username.tooltip',\n              'password.forgot.email.or.username.placeholder',\n              'login'\n            ),\n            'explain-top': true,\n            name: 'username',\n            input: TextBox,\n            inputId: 'account-recovery-username',\n            autoComplete: Util.getAutocompleteValue(this.settings, 'username'),\n            type: 'text',\n            inlineValidation: false,\n          })\n        );\n        if (smsEnabled || callEnabled) {\n          formChildren.push(\n            FormType.View({\n              View: View.extend({\n                template: hbs(\n                  '\\\n                  <p class=\"mobile-recovery-hint\">\\\n                    {{i18n code=\"recovery.mobile.hint\" bundle=\"login\" arguments=\"mobileFactors\"}}\\\n                  </p>'\n                ),\n                getTemplateData: function() {\n                  let mobileFactors;\n\n                  if (smsEnabled && callEnabled) {\n                    mobileFactors = loc('recovery.smsOrCall');\n                  } else if (callEnabled) {\n                    mobileFactors = loc('recovery.call');\n                  } else {\n                    mobileFactors = loc('recovery.sms');\n                  }\n                  return { mobileFactors: mobileFactors };\n                },\n              }),\n            })\n          );\n        }\n        if (smsEnabled) {\n          this.$el.addClass('forgot-password-sms-enabled');\n          formChildren.push(\n            this.createRecoveryFactorButton(\n              'sms-button',\n              'password.forgot.sendText',\n              Enums.RECOVERY_FACTOR_TYPE_SMS,\n              this\n            )\n          );\n          this.setDefaultFactorType(Enums.RECOVERY_FACTOR_TYPE_SMS);\n        }\n        if (callEnabled) {\n          this.$el.addClass('forgot-password-call-enabled');\n          formChildren.push(\n            this.createRecoveryFactorButton(\n              'call-button',\n              'password.forgot.call',\n              Enums.RECOVERY_FACTOR_TYPE_CALL,\n              this\n            )\n          );\n          this.setDefaultFactorType(Enums.RECOVERY_FACTOR_TYPE_CALL);\n        }\n        if (emailEnabled) {\n          this.$el.addClass('forgot-password-email-enabled');\n          formChildren.push(\n            this.createRecoveryFactorButton(\n              'email-button',\n              'password.forgot.sendEmail',\n              Enums.RECOVERY_FACTOR_TYPE_EMAIL,\n              this\n            )\n          );\n          this.setDefaultFactorType(Enums.RECOVERY_FACTOR_TYPE_EMAIL);\n        }\n      }\n\n      return formChildren;\n    },\n    initialize: function() {\n      this.listenTo(this.state, 'contactSupport', function() {\n        this.add(ContactSupport, '.o-form-error-container');\n      });\n\n      this.listenTo(this, 'save', function() {\n        this.options.appState.set('username', this.model.get('username'));\n        this.model.save();\n      });\n    },\n    setDefaultFactorType: function(factorType) {\n      if (_.isEmpty(this.model.get('factorType'))) {\n        this.model.set('factorType', factorType);\n      }\n    },\n    createRecoveryFactorButton: function(className, labelCode, factorType, form) {\n      return FormType.Button({\n        attributes: { 'data-se': className },\n        className: 'button button-primary button-wide ' + className,\n        title: loc(labelCode, 'login'),\n        click: function() {\n          form.clearErrors();\n          if (this.model.isValid()) {\n            this.model.set('factorType', factorType);\n            form.trigger('save', this.model);\n          }\n        },\n      });\n    },\n  },\n  Footer: ForgotPasswordControllerFooter,\n\n  initialize: function() {\n    this.options.appState.unset('username');\n  },\n});\n"],"names":["ForgotPasswordControllernoFactorsError","View","extend","template","ForgotPasswordControllerFooter","className","events","e","preventDefault","back","state","trigger","$","hide","getTemplateData","hideBackToSignInForReset","settings","get","helpSupportNumber","set","Enums","DIRECTION_BACK","options","appState","FormController","Model","props","username","factorType","validate","ValidationUtil","validateUsername","save","self","relayState","startTransaction","authClient","forgotPassword","transformUsername","FORGOT_PASSWORD","catch","Form","noButtonBar","title","_","partial","loc","formChildren","smsEnabled","callEnabled","emailEnabled","noFactorsEnabled","add","push","FormType","Input","label","explain","Util","createInputExplain","name","input","TextBox","inputId","autoComplete","getAutocompleteValue","type","inlineValidation","mobileFactors","$el","addClass","createRecoveryFactorButton","RECOVERY_FACTOR_TYPE_SMS","setDefaultFactorType","RECOVERY_FACTOR_TYPE_CALL","RECOVERY_FACTOR_TYPE_EMAIL","initialize","listenTo","ContactSupport","model","isEmpty","labelCode","form","Button","attributes","click","clearErrors","isValid","Footer","unset"],"mappings":"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"}