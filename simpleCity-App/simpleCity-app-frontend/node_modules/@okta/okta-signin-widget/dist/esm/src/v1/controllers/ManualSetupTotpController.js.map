{"version":3,"file":"ManualSetupTotpController.js","sources":["../../../../../src/v1/controllers/ManualSetupTotpController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, loc, View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport FactorUtil from 'util/FactorUtil';\nimport FormController from 'v1/util/FormController';\nimport FormType from 'v1/util/FormType';\nimport RouterUtil from 'v1/util/RouterUtil';\nimport ManualSetupFooter from 'v1/views/enroll-factors/ManualSetupFooter';\nexport default FormController.extend({\n  className: 'enroll-manual-totp',\n  Model: function() {\n    return {\n      local: {\n        sharedSecret: ['string', false, this.options.appState.get('sharedSecret')],\n        __factorType__: ['string', false, this.options.factorType],\n        __provider__: ['string', false, this.options.provider],\n      },\n    };\n  },\n\n  Form: {\n    title: function() {\n      const factorName = FactorUtil.getFactorLabel(this.model.get('__provider__'), this.model.get('__factorType__'));\n\n      return loc('enroll.totp.title', 'login', [factorName]);\n    },\n    subtitle: _.partial(loc, 'enroll.totp.cannotScanBarcode', 'login'),\n    noButtonBar: true,\n    attributes: { 'data-se': 'step-manual-setup' },\n\n    formChildren: function() {\n      const instructions = this.settings.get('brandName')\n        ? loc('enroll.totp.manualSetupInstructions.specific', 'login', [this.settings.get('brandName')])\n        : loc('enroll.totp.manualSetupInstructions.generic', 'login');\n\n      return [\n        FormType.View({\n          View: View.extend({\n            className: 'secret-key-instructions',\n            attributes: { 'data-se': 'secret-key-instructions'},\n            template: hbs`\n             <section aria-live=\"assertive\">\n                <p  class=\"okta-form-subtitle o-form-explain text-align-c\">\n                  {{instructions}}\n                </p>\n                <p class=\"shared-key margin-top-10\" tabindex=0 \n                aria-label=\"{{i18n code=\"enroll.totp.sharedSecretInstructions.aria.secretKey\" bundle=\"login\"\n                arguments=\"sharedSecretKey\"}}\">{{sharedSecretKey}}</p>\n              </section>\n              `,\n            initialize: function(){\n              this.listenTo(this.model, 'change:sharedSecret', this.render);\n            },\n            getTemplateData: function() {\n              return {\n                instructions: instructions,\n                sharedSecretKey: this.model.get('sharedSecret')\n              };\n            },\n          })\n        }),\n        FormType.Toolbar({\n          noCancelButton: true,\n          save: loc('oform.next', 'login'),\n        }),\n      ];\n    },\n  },\n\n  Footer: ManualSetupFooter,\n\n  initialize: function() {\n    this.listenTo(this.form, 'save', function() {\n      const url = RouterUtil.createActivateFactorUrl(\n        this.model.get('__provider__'),\n        this.model.get('__factorType__'),\n        'activate'\n      );\n\n      this.options.appState.trigger('navigate', url);\n    });\n  },\n});\n"],"names":["FormController","extend","className","Model","local","sharedSecret","options","appState","get","__factorType__","factorType","__provider__","provider","Form","title","factorName","FactorUtil","getFactorLabel","model","loc","subtitle","_","partial","noButtonBar","attributes","formChildren","instructions","settings","FormType","View","template","initialize","listenTo","render","getTemplateData","sharedSecretKey","Toolbar","noCancelButton","save","Footer","ManualSetupFooter","form","url","RouterUtil","createActivateFactorUrl","trigger"],"mappings":"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"}