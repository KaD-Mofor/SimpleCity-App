{"version":3,"file":"TerminalView.js","sources":["../../../../../../src/v2/view-builder/views/TerminalView.js"],"sourcesContent":["import { loc, createCallout } from '@okta/courage';\nimport { BaseForm, BaseFooter, BaseView } from '../internals';\nimport { getBackToSignInLink, getSkipSetupLink, getReloadPageButtonLink } from '../utils/LinksUtil';\nimport EmailAuthenticatorHeader from '../components/EmailAuthenticatorHeader';\nimport { OTPInformationTerminalView } from './consent/EmailMagicLinkOTPTerminalView';\nimport CustomAccessDeniedErrorMessage from './shared/CustomAccessDeniedErrorMessage';\nimport EndUserRemediationTerminalMessage from './end-user-remediation/EndUserRemediationTerminalMessage';\n\nconst RETURN_LINK_EXPIRED_KEY = 'idx.return.link.expired';\nconst IDX_RETURN_LINK_OTP_ONLY = 'idx.enter.otp.in.original.tab';\nconst SAFE_MODE_KEY_PREFIX = 'idx.error.server.safe.mode';\nconst UNLOCK_ACCOUNT_TERMINAL_KEY = 'oie.selfservice.unlock_user.success.message';\nconst UNLOCK_ACCOUNT_FAILED_PERMISSIONS = 'oie.selfservice.unlock_user.challenge.failed.permissions';\nconst RESET_PASSWORD_NOT_ALLOWED = 'oie.selfservice.reset.password.not.allowed';\nconst RETURN_TO_ORIGINAL_TAB_KEY = 'idx.return.to.original.tab';\nconst OPERATION_CANCELED_ON_OTHER_DEVICE_KEY = 'idx.operation.cancelled.on.other.device';\nconst OPERATION_CANCELED_BY_USER_KEY = 'idx.operation.cancelled.by.user';\nconst DEVICE_ACTIVATED = 'idx.device.activated';\nconst DEVICE_NOT_ACTIVATED_CONSENT_DENIED = 'idx.device.not.activated.consent.denied';\nconst DEVICE_NOT_ACTIVATED_INTERNAL_ERROR = 'idx.device.not.activated.internal.error';\nconst FLOW_CONTINUE_IN_NEW_TAB = 'idx.transferred.to.new.tab';\nconst EMAIL_LINK_OUT_OF_DATE = 'idx.return.stale';\nconst EMAIL_LINK_CANT_BE_PROCESSED = 'idx.return.error';\nconst EMAIL_VERIFICATION_REQUIRED = 'idx.email.verification.required';\nconst END_USER_REMEDIATION_KEY_PREFIX = 'idx.error.code.access_denied.device_assurance.remediation.';\n\nconst EMAIL_ACTIVATION_EMAIL_EXPIRE = 'idx.expired.activation.token';\nconst EMAIL_ACTIVATION_EMAIL_INVALID = 'idx.missing.activation.token';\nconst EMAIL_ACTIVATION_EMAIL_SUBMITTED = 'idx.request.activation.email';\nconst EMAIL_ACTIVATION_EMAIL_SUSPENDED = 'idx.activating.inactive.user';\n\nconst CUSTOM_ACCESS_DENIED_KEY = 'security.access_denied_custom_message';\n\nexport const REGISTRATION_NOT_ENABLED = 'oie.registration.is.not.enabled';\nexport const FORGOT_PASSWORD_NOT_ENABLED = 'oie.forgot.password.is.not.enabled';\n\nconst EMAIL_AUTHENTICATOR_TERMINAL_KEYS = [\n  FLOW_CONTINUE_IN_NEW_TAB,\n  EMAIL_LINK_OUT_OF_DATE,\n  EMAIL_LINK_CANT_BE_PROCESSED,\n  EMAIL_VERIFICATION_REQUIRED,\n  RETURN_TO_ORIGINAL_TAB_KEY,\n  RETURN_LINK_EXPIRED_KEY,\n  OPERATION_CANCELED_ON_OTHER_DEVICE_KEY,\n  OPERATION_CANCELED_BY_USER_KEY,\n  IDX_RETURN_LINK_OTP_ONLY,\n];\n\nconst DEVICE_CODE_ERROR_KEYS = [\n  DEVICE_NOT_ACTIVATED_CONSENT_DENIED,\n  DEVICE_NOT_ACTIVATED_INTERNAL_ERROR\n];\n\nconst DEVICE_CODE_FLOW_TERMINAL_KEYS = [\n  DEVICE_ACTIVATED,\n  ...DEVICE_CODE_ERROR_KEYS\n];\n\n// These terminal views build their own links, basically they have cancel remediation in error response\n// Or doesn't require a Back to Sign in link because the flow didn't start from login screen\nconst NO_BACKTOSIGNIN_LINK_VIEWS = [\n  UNLOCK_ACCOUNT_TERMINAL_KEY,\n  RETURN_TO_ORIGINAL_TAB_KEY,\n  FLOW_CONTINUE_IN_NEW_TAB,\n  OPERATION_CANCELED_ON_OTHER_DEVICE_KEY,\n  ...DEVICE_CODE_FLOW_TERMINAL_KEYS,\n  UNLOCK_ACCOUNT_FAILED_PERMISSIONS,\n  RESET_PASSWORD_NOT_ALLOWED,\n  IDX_RETURN_LINK_OTP_ONLY,\n];\n\n// Key map to transform terminal view titles {ApiKey : WidgetKey}  \nconst terminalViewTitles = {\n  [RETURN_LINK_EXPIRED_KEY] : 'oie.email.return.link.expired.title',\n  [UNLOCK_ACCOUNT_TERMINAL_KEY] : 'account.unlock.unlocked.title',\n  [DEVICE_ACTIVATED] : 'device.code.activated.success.title',\n  [REGISTRATION_NOT_ENABLED] : 'oie.registration.form.title',\n  [FORGOT_PASSWORD_NOT_ENABLED] : 'password.reset.title.generic',\n  [EMAIL_ACTIVATION_EMAIL_EXPIRE] : 'oie.activation.request.email.title.expire',\n  [EMAIL_ACTIVATION_EMAIL_SUBMITTED] : 'oie.activation.request.email.title.submitted',\n  [EMAIL_ACTIVATION_EMAIL_SUSPENDED] : 'oie.activation.request.email.title.suspended',\n  [EMAIL_ACTIVATION_EMAIL_INVALID] : 'oie.activation.request.email.title.invalid',\n  [DEVICE_NOT_ACTIVATED_CONSENT_DENIED] : 'device.code.activated.error.title',\n  [DEVICE_NOT_ACTIVATED_INTERNAL_ERROR] : 'device.code.activated.error.title',\n  [RETURN_TO_ORIGINAL_TAB_KEY] : 'oie.consent.enduser.email.allow.title',\n  [IDX_RETURN_LINK_OTP_ONLY]: 'idx.return.link.otponly.your.verification.code',\n};\n\nconst Body = BaseForm.extend({\n  noButtonBar: true,\n\n  postRender() {\n    BaseForm.prototype.postRender.apply(this, arguments);\n    this.$el.addClass('terminal-state');\n\n    // show device code terminal icons\n    if (this.options.appState.containsMessageWithI18nKey(DEVICE_CODE_FLOW_TERMINAL_KEYS)) {\n      const iconClass = this.options.appState.containsMessageWithI18nKey(DEVICE_ACTIVATED)\n        ? 'success-24-green' : 'error-24-red';\n      this.$('.o-form-head').before('<div class=\"device-code-terminal--icon-container\">' +\n        '<span class=\"device-code-terminal--icon ' + iconClass + '\"></span>' +\n        '</div>');\n    }\n  },\n\n  title() {\n    return this.getTerminalViewTitle();\n  },\n\n  getTerminalViewTitle() {\n    if (this.options.appState.containsMessageStartingWithI18nKey(SAFE_MODE_KEY_PREFIX)) {\n      return loc('oie.safe.mode.title', 'login');\n    }\n\n    const apiKeys = Object.keys(terminalViewTitles);\n    const key = apiKeys.find(key => this.options.appState.containsMessageWithI18nKey(key));\n    if (key) {\n      return loc(terminalViewTitles[key], 'login');\n    }\n  },\n\n  prepareMessageForCustomView(messagesObjs) {\n    let hasCustomView = false;\n    if (this.options.appState.containsMessageWithI18nKey(IDX_RETURN_LINK_OTP_ONLY)) {\n      this.add(OTPInformationTerminalView);\n      hasCustomView = true;\n    } else if (this.options.appState.containsMessageStartingWithI18nKey(CUSTOM_ACCESS_DENIED_KEY)) {\n      this.add(createCallout({\n        type: 'error',\n        content: new CustomAccessDeniedErrorMessage(\n          { message: messagesObjs.value[0].message, links: messagesObjs.value[0].links })\n      }));\n      hasCustomView = true;\n    } else if (this.options.appState.containsMessageStartingWithI18nKey(END_USER_REMEDIATION_KEY_PREFIX)) {\n      this.add(createCallout({\n        type: 'error',\n        content: new EndUserRemediationTerminalMessage({messages: messagesObjs}),\n      }));\n      hasCustomView = true;\n    }\n\n    return hasCustomView;\n  },\n\n  showMessages() {\n    const messagesObjs = this.options.appState.get('messages');\n    let hasCustomView = false;\n    let description;\n    if (this.options.appState.containsMessageWithI18nKey(OPERATION_CANCELED_ON_OTHER_DEVICE_KEY)) {\n      description = loc('idx.operation.cancelled.on.other.device', 'login');\n      messagesObjs.value.push({ message: loc('oie.consent.enduser.deny.description', 'login') });\n    } else if (this.options.appState.containsMessageWithI18nKey(RETURN_TO_ORIGINAL_TAB_KEY)) {\n      description = loc('oie.consent.enduser.email.allow.description', 'login');\n      messagesObjs.value.push({ message: loc('oie.return.to.original.tab', 'login')});\n    } else if (this.options.appState.containsMessageWithI18nKey('tooManyRequests')) {\n      description = loc('oie.tooManyRequests', 'login');\n    } else if (this.options.appState.containsMessageWithI18nKey(RETURN_LINK_EXPIRED_KEY)) {\n      messagesObjs.value[0].class = 'ERROR';\n    } else {\n      hasCustomView = this.prepareMessageForCustomView(messagesObjs);\n    }\n\n    if (description && Array.isArray(messagesObjs?.value)) {\n      messagesObjs.value[0].message = description;\n    }\n\n    this.options.appState.set('messages', messagesObjs);\n    if (!hasCustomView) {\n      BaseForm.prototype.showMessages.call(this);\n    }\n  },\n\n});\n\nconst Footer = BaseFooter.extend({\n  // All terminal views should have Back to sign in link either widget configured or server configured.\n  links: function() {\n    if (this.options.appState.containsMessageStartingWithI18nKey(SAFE_MODE_KEY_PREFIX)) {\n      return getSkipSetupLink(this.options.appState);\n    }\n    if (this.options.appState.containsMessageWithI18nKey(DEVICE_CODE_ERROR_KEYS)) {\n      return getReloadPageButtonLink();\n    }\n    // If cancel object exists idx response then view would take care of rendering back to sign in link\n    if (!this.options.appState.hasActionObject('cancel') &&\n        !this.options.appState.containsMessageWithI18nKey(NO_BACKTOSIGNIN_LINK_VIEWS)) {\n      // TODO OKTA-432869 \"back to sign in\" links to org baseUrl, does not work correctly with embedded widget\n      return getBackToSignInLink(this.options);\n    }\n  }\n});\n\nexport default BaseView.extend({\n  initialize() {\n    BaseView.prototype.initialize.apply(this, arguments);\n    if (this.options.appState.containsMessageWithI18nKey(EMAIL_AUTHENTICATOR_TERMINAL_KEYS)) {\n      this.Header = EmailAuthenticatorHeader;\n    }\n  },\n  Body,\n  Footer\n});\n"],"names":["RETURN_LINK_EXPIRED_KEY","IDX_RETURN_LINK_OTP_ONLY","SAFE_MODE_KEY_PREFIX","UNLOCK_ACCOUNT_TERMINAL_KEY","UNLOCK_ACCOUNT_FAILED_PERMISSIONS","RESET_PASSWORD_NOT_ALLOWED","RETURN_TO_ORIGINAL_TAB_KEY","OPERATION_CANCELED_ON_OTHER_DEVICE_KEY","OPERATION_CANCELED_BY_USER_KEY","DEVICE_ACTIVATED","DEVICE_NOT_ACTIVATED_CONSENT_DENIED","DEVICE_NOT_ACTIVATED_INTERNAL_ERROR","FLOW_CONTINUE_IN_NEW_TAB","EMAIL_LINK_OUT_OF_DATE","EMAIL_LINK_CANT_BE_PROCESSED","EMAIL_VERIFICATION_REQUIRED","END_USER_REMEDIATION_KEY_PREFIX","EMAIL_ACTIVATION_EMAIL_EXPIRE","EMAIL_ACTIVATION_EMAIL_INVALID","EMAIL_ACTIVATION_EMAIL_SUBMITTED","EMAIL_ACTIVATION_EMAIL_SUSPENDED","CUSTOM_ACCESS_DENIED_KEY","REGISTRATION_NOT_ENABLED","FORGOT_PASSWORD_NOT_ENABLED","EMAIL_AUTHENTICATOR_TERMINAL_KEYS","DEVICE_CODE_ERROR_KEYS","DEVICE_CODE_FLOW_TERMINAL_KEYS","NO_BACKTOSIGNIN_LINK_VIEWS","terminalViewTitles","Body","BaseForm","extend","noButtonBar","postRender","prototype","apply","arguments","$el","addClass","options","appState","containsMessageWithI18nKey","iconClass","$","before","title","getTerminalViewTitle","containsMessageStartingWithI18nKey","loc","apiKeys","Object","keys","key","find","prepareMessageForCustomView","messagesObjs","hasCustomView","add","OTPInformationTerminalView","createCallout","type","content","CustomAccessDeniedErrorMessage","message","value","links","EndUserRemediationTerminalMessage","messages","showMessages","get","description","push","class","Array","isArray","set","call","Footer","BaseFooter","getSkipSetupLink","getReloadPageButtonLink","hasActionObject","getBackToSignInLink","BaseView","initialize","Header","EmailAuthenticatorHeader"],"mappings":"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"}