{"version":3,"file":"LinksUtil.js","sources":["../../../../../../src/v2/view-builder/utils/LinksUtil.js"],"sourcesContent":["import { loc, _ } from '@okta/courage';\nimport { ACTIONS, FORMS as RemediationForms } from '../../ion/RemediationConstants';\n\nconst { ENROLLED_PASSWORD_RECOVERY_LINK, ORG_PASSWORD_RECOVERY_LINK } = ACTIONS;\n\nconst getSwitchAuthenticatorLink = (appState) => {\n  if (appState.getRemediationAuthenticationOptions(RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE).length > 1) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.verification.switch.authenticator', 'login'),\n        'name': 'switchAuthenticator',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE,\n      }\n    ];\n  }\n\n  if (appState.getRemediationAuthenticationOptions(RemediationForms.SELECT_AUTHENTICATOR_ENROLL).length >= 1) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.enroll.switch.authenticator', 'login'),\n        'name': 'switchAuthenticator',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_ENROLL,\n      }\n    ];\n  }\n\n  return [];\n};\n\nconst getForgotPasswordLink = (appState, settings) => {\n  const forgotPasswordLink = {\n    'type': 'link',\n    'label': loc('forgotpassword', 'login'),\n    'name': 'forgot-password',\n  };\n\n  const customForgotPasswordHref = settings.get('helpLinks.forgotPassword');\n\n  if (customForgotPasswordHref) {\n    return [\n      Object.assign({}, {\n        'href': customForgotPasswordHref,\n        'label': loc('forgotpassword', 'login'),\n        'name': 'forgot-password',\n      }),\n    ];\n  }\n\n  // at identify page when only Org Authenticator Password may be available\n  else if (appState.getActionByPath(ORG_PASSWORD_RECOVERY_LINK)) {\n    return [\n      Object.assign({}, forgotPasswordLink, { actionPath: ORG_PASSWORD_RECOVERY_LINK })\n    ];\n  }\n\n  // at password verify page\n  else if (appState.getActionByPath(ENROLLED_PASSWORD_RECOVERY_LINK)) {\n    return [\n      Object.assign({}, forgotPasswordLink, { actionPath: ENROLLED_PASSWORD_RECOVERY_LINK })\n    ];\n  }\n\n  return [];\n};\n\nconst goBackLink = (appState) => {\n  if (appState.hasRemediationObject(RemediationForms.SELECT_AUTHENTICATOR_ENROLL)) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.go.back', 'login'),\n        'name': 'go-back',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_ENROLL,\n      }\n    ];\n  }\n\n  return [];\n};\n\nconst getSkipSetupLink = (appState, linkName) => {\n  if (appState.hasRemediationObject(RemediationForms.SKIP)) {\n    return [\n      {\n        'type': 'link',\n        'label': linkName ?? loc('oie.enroll.skip.setup', 'login'),\n        'name': 'skip-setup',\n        'actionPath': RemediationForms.SKIP,\n      }\n    ];\n  }\n\n  return [];\n};\n\n// When there is a 'cancel' object in remediation\nconst getSignOutLink = (settings, options = {}) => {\n  if (settings?.get('backToSignInUri')) {\n    return [\n      {\n        'label': loc('goback', 'login'),\n        'name': 'cancel',\n        'href': settings.get('backToSignInUri')\n      },\n    ];\n  }\n\n  return [\n    {\n      'actionPath': 'cancel',\n      'label': !options.label ? loc('goback', 'login') : options.label,\n      'name': 'cancel',\n      'type': 'link'\n    },\n  ];\n};\n\n// Use it to create a widget configured link in the absence of `cancel` object in remediation\nconst getBackToSignInLink = ({settings, appState}) => {\n  const link = {};\n\n  // If backToSignInLink is set, use this value for all scenarios\n  if (settings?.get('backToSignInUri')) {\n    link.href = settings.get('backToSignInUri');\n  }\n  // fallback for embedded scenarios\n  else if (settings?.get('oauth2Enabled')) {\n    link.clickHandler = () => {\n      appState.trigger('restartLoginFlow');\n    };\n  }\n  // fallback for okta-hosted scenarios (backend should set signOutLink or backToSignOutLink)\n  else {\n    link.href = settings?.get('baseUrl');\n  }\n\n  return [\n    {\n      'type': 'link',\n      'label': loc('goback', 'login'),\n      'name': 'go-back',\n      ...link\n    },\n  ];\n};\n\nconst getReloadPageButtonLink = () => {\n  return [\n    {\n      'type': 'link',\n      'label': loc('oie.try.again', 'login'),\n      'name': 'try-again',\n      'href': window.location,\n      'className': 'button button-primary text-align-c'\n    },\n  ];\n};\n\nconst getSignUpLink = (appState, settings) => {\n  const signupLink = [];\n\n  if (appState.hasRemediationObject(RemediationForms.SELECT_ENROLL_PROFILE)) {\n    const signupLinkData = {\n      'type': 'link',\n      'label': loc('oie.registration.form.title', 'login'),\n      'name': 'enroll'\n    };\n    if (_.isFunction(settings.get('registration.click'))) {\n      signupLinkData.clickHandler = settings.get('registration.click');\n    } else {\n      signupLinkData.actionPath = RemediationForms.SELECT_ENROLL_PROFILE;\n    }\n    signupLink.push(signupLinkData);\n  }\n\n  return signupLink;\n};\n\nconst getFactorPageCustomLink = (appState, settings) => {\n  const factorPageCustomLink = [];\n  const formsNeedFactorPageCustomLink = [\n    RemediationForms.CHALLENGE_AUTHENTICATOR,\n    RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE,\n    RemediationForms.CHALLENGE_POLL,\n    RemediationForms.AUTHENTICATOR_VERIFICATION_DATA,\n  ];\n\n  if (!appState.get('isPasswordRecovery') && formsNeedFactorPageCustomLink.includes(appState.get('currentFormName'))) {\n    const helpLinksFactorPageLabel = settings.get('helpLinks.factorPage.text');\n    const helpLinksFactorPageHref = settings.get('helpLinks.factorPage.href');\n\n    if (helpLinksFactorPageLabel && helpLinksFactorPageHref) {\n      factorPageCustomLink.push({\n        type: 'link',\n        label: helpLinksFactorPageLabel,\n        name: 'factorPageHelpLink',\n        href: helpLinksFactorPageHref,\n        target: '_blank',\n      });\n    }\n  }\n  return factorPageCustomLink;\n};\n\nexport {\n  getSwitchAuthenticatorLink,\n  getForgotPasswordLink,\n  goBackLink,\n  getSignUpLink,\n  getSignOutLink,\n  getBackToSignInLink,\n  getSkipSetupLink,\n  getReloadPageButtonLink,\n  getFactorPageCustomLink,\n};\n"],"names":["ENROLLED_PASSWORD_RECOVERY_LINK","ORG_PASSWORD_RECOVERY_LINK","ACTIONS","getSwitchAuthenticatorLink","appState","getRemediationAuthenticationOptions","RemediationForms","SELECT_AUTHENTICATOR_AUTHENTICATE","length","loc","SELECT_AUTHENTICATOR_ENROLL","getForgotPasswordLink","settings","forgotPasswordLink","customForgotPasswordHref","get","Object","assign","getActionByPath","actionPath","getSkipSetupLink","linkName","hasRemediationObject","SKIP","getSignOutLink","options","label","getBackToSignInLink","link","href","clickHandler","trigger","getReloadPageButtonLink","window","location","getSignUpLink","signupLink","SELECT_ENROLL_PROFILE","signupLinkData","_","isFunction","push","getFactorPageCustomLink","factorPageCustomLink","formsNeedFactorPageCustomLink","CHALLENGE_AUTHENTICATOR","CHALLENGE_POLL","AUTHENTICATOR_VERIFICATION_DATA","includes","helpLinksFactorPageLabel","helpLinksFactorPageHref","type","name","target"],"mappings":"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"}