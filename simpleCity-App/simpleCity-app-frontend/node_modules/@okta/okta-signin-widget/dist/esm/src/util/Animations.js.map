{"version":3,"file":"Animations.js","sources":["../../../../src/util/Animations.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint max-statements: [2, 16] */\n\nimport Q from 'q';\nimport Enums from './Enums';\nconst SWAP_PAGE_TIME = 200;\nconst fn = {};\n\nfunction zoom($el, start, finish) {\n  const deferred = Q.defer();\n\n  $el.animate(\n    {\n      'text-indent': 1,\n    },\n    {\n      duration: 200,\n      easing: 'swing',\n      step: function(now, fx) {\n        fx.start = start;\n        fx.end = finish;\n        $el.css('transform', 'scale(' + now + ', ' + now + ')');\n      },\n      always: function() {\n        deferred.resolve($el);\n      },\n    }\n  );\n  return deferred.promise;\n}\n\nfunction rotate($el, start, finish) {\n  const deferred = Q.defer();\n\n  $el.animate(\n    {\n      'text-indent': 1,\n    },\n    {\n      duration: 150,\n      easing: 'swing',\n      step: function(now, fx) {\n        fx.start = start;\n        fx.end = finish;\n        $el.css('transform', 'rotate(' + now + 'deg)');\n      },\n      always: function() {\n        deferred.resolve($el);\n      },\n    }\n  );\n  return deferred.promise;\n}\n\n// Note: It is necessary to pass in a success callback because we must\n// remove the old dom node (and controller) in the same tick of the event\n// loop. Waiting for \"then\" results in a glitchy animation.\nfn.swapPages = function(options) {\n  const deferred = Q.defer();\n  const $parent = options.$parent;\n  const $oldRoot = options.$oldRoot;\n  const $newRoot = options.$newRoot;\n  const success = options.success;\n  const ctx = options.ctx;\n  let directionClassName = 'transition-from-right';\n\n  if (options.dir && options.dir === Enums.DIRECTION_BACK) {\n    directionClassName = 'transition-from-left';\n  }\n\n  $newRoot.addClass(directionClassName);\n  $parent.append($newRoot);\n\n  $parent.addClass('animation-container-overflow');\n  const newRootAnimations = { left: '0px', top: '0px', opacity: 1 };\n  $newRoot.animate(newRootAnimations, SWAP_PAGE_TIME, function() {\n    $parent.removeClass('animation-container-overflow');\n    $newRoot.removeClass(directionClassName);\n    const clearStyles = Object.keys(newRootAnimations).reduce((styles, attr) => ({ ...styles, [attr]: '' }), {});\n    $newRoot.css(clearStyles);\n    success.call(ctx);\n    deferred.resolve();\n  });\n\n  $oldRoot.animate({ height: $newRoot.height(), opacity: 0 }, SWAP_PAGE_TIME * 0.8);\n\n  return deferred.promise;\n};\n\nfn.swapBeacons = function(options) {\n  const $el = options.$el;\n  const swap = options.swap;\n  const ctx = options.ctx;\n\n  return this.implode($el)\n    .then(function() {\n      swap.call(ctx);\n      return $el;\n    })\n    .then(this.explode);\n};\n\nfn.explode = function($el) {\n  return zoom($el, 0, 1); //zoom in\n};\n\nfn.implode = function($el) {\n  return zoom($el, 1, 0); //zoom out\n};\n\nfn.radialProgressBar = function(options) {\n  const radialProgressBar = options.$el;\n  const swap = options.swap;\n  const circles = radialProgressBar.children();\n\n  return rotate(circles, 0, 180)\n    .then(function() {\n      radialProgressBar.css({ clip: 'auto' });\n    })\n    .then(function() {\n      const leftHalf = circles.eq(0);\n\n      swap();\n      return rotate(leftHalf, 180, 360);\n    })\n    .then(function() {\n      //reset values to initial state\n      radialProgressBar.css({ clip: 'rect(0px, 96px, 96px, 48px)' });\n      circles.css({\n        transform: 'rotate(0deg)',\n        'text-indent': '1px',\n      });\n    });\n};\n\nexport default fn;\n"],"names":["SWAP_PAGE_TIME","fn","zoom","$el","start","finish","deferred","Q","defer","animate","duration","easing","step","now","fx","end","css","always","resolve","promise","rotate","swapPages","options","$parent","$oldRoot","$newRoot","success","ctx","directionClassName","dir","Enums","DIRECTION_BACK","addClass","append","newRootAnimations","left","top","opacity","removeClass","clearStyles","Object","keys","reduce","styles","attr","call","height","swapBeacons","swap","implode","then","explode","radialProgressBar","circles","children","clip","leftHalf","eq","transform"],"mappings":"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"}