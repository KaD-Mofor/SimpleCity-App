{"version":3,"file":"FormController.js","sources":["../../../../../src/v1/util/FormController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, internal, Form, createButton } from '@okta/courage';\nimport BaseLoginModel from 'v1/models/BaseLoginModel';\nimport BaseLoginController from './BaseLoginController';\nimport FormType from './FormType';\nlet { Toolbar } = internal.views.forms.components;\nlet { FormUtil } = internal.views.forms.helpers;\nconst FormControllerSimpleForm = Form.extend({\n  layout: 'o-form-theme',\n  noCancelButton: true,\n  constructor: function(options) {\n    Form.call(this, options);\n    _.each(\n      _.result(this, 'formChildren') || [],\n      function(child) {\n        switch (child.type) {\n        case FormType.INPUT:\n          this.addInput(\n            _.extend(\n              {\n                label: false,\n                'label-top': true,\n              },\n              child.viewOptions\n            )\n          );\n          break;\n        case FormType.BUTTON:\n          this.add(createButton(_.extend({ model: this.model }, child.viewOptions)), child.addOptions);\n          FormUtil.applyShowWhen(this.last(), child.viewOptions && child.viewOptions.showWhen);\n          break;\n        case FormType.DIVIDER:\n          this.addDivider(child.viewOptions);\n          break;\n        case FormType.TOOLBAR:\n          this.add(Toolbar, { options: child.viewOptions });\n          FormUtil.applyShowWhen(this.last(), child.viewOptions && child.viewOptions.showWhen);\n          break;\n        case FormType.VIEW:\n          this.add(child.viewOptions.View, child.addOptions);\n          FormUtil.applyShowWhen(this.last(), child.viewOptions.showWhen);\n          break;\n        default:\n          throw new Error('Unrecognized child type: ' + child.type);\n        }\n      },\n      this\n    );\n  },\n});\nexport default BaseLoginController.extend({\n  constructor: function() {\n    const initialize = this.initialize;\n\n    this.initialize = function() {};\n\n    BaseLoginController.apply(this, arguments);\n\n    if (this.Model && this.Form) {\n      const Model = BaseLoginModel.extend(\n        _.extend(\n          {\n            parse: function(attributes) {\n              this.settings = attributes.settings;\n              this.appState = attributes.appState;\n              return _.omit(attributes, ['settings', 'appState']);\n            },\n          },\n          _.result(this, 'Model')\n        )\n      );\n\n      this.model = new Model(\n        {\n          settings: this.settings,\n          appState: this.options.appState,\n        },\n        { parse: true }\n      );\n      const Form = FormControllerSimpleForm.extend(_.result(this, 'Form', this));\n\n      this.form = new Form(this.toJSON());\n      this.add(this.form);\n    }\n\n    if (this.Footer) {\n      this.addFooter(this.Footer);\n    }\n\n    this.addListeners();\n    initialize.apply(this, arguments);\n  },\n\n  addFooter: function(Footer, args) {\n    this.footer = new Footer(_.extend(this.toJSON(), args || {}));\n    this.add(this.footer);\n  },\n\n  toJSON: function() {\n    const data = BaseLoginController.prototype.toJSON.apply(this, arguments);\n\n    return _.extend(_.pick(this.options, 'appState'), data);\n  },\n\n  back: function() {\n    if (this.footer && this.footer.back) {\n      this.footer.back();\n    }\n  },\n});\n"],"names":["Toolbar","internal","views","forms","components","FormUtil","helpers","FormControllerSimpleForm","Form","extend","layout","noCancelButton","constructor","options","call","_","each","result","child","type","FormType","INPUT","addInput","label","viewOptions","BUTTON","add","createButton","model","addOptions","applyShowWhen","last","showWhen","DIVIDER","addDivider","TOOLBAR","VIEW","View","Error","BaseLoginController","initialize","apply","arguments","Model","BaseLoginModel","parse","attributes","settings","appState","omit","form","toJSON","Footer","addFooter","addListeners","args","footer","data","prototype","pick","back"],"mappings":"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"}