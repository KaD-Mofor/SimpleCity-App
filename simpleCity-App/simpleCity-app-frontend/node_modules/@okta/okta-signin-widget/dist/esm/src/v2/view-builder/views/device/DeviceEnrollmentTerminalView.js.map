{"version":3,"file":"DeviceEnrollmentTerminalView.js","sources":["../../../../../../../src/v2/view-builder/views/device/DeviceEnrollmentTerminalView.js"],"sourcesContent":["import { loc } from '@okta/courage';\nimport { BaseForm, BaseView } from '../../internals';\nimport { IosAndAndroidLoopbackOdaTerminalView,\n  AndroidAppLinkWithAccountOdaTerminalView,\n  AndroidAppLinkWithoutAccountOdaTerminalView,\n  getDeviceEnrollmentContext} from '../../components/OdaOktaVerifyTerminalView';\nimport MdmOktaVerifyTerminalView from '../../components/MdmOktaVerifyTerminalView';\nimport Enums from 'util/Enums';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader';\nimport Link from '../../components/Link';\n\nconst BaseDeviceEnrollTerminalForm = BaseForm.extend({\n  noButtonBar: true,\n  className: 'device-enrollment-terminal',\n});\n\nconst AndroidAppLinkPreselectForm = BaseForm.extend({\n  attributes: { 'data-se': 'android-app-link-setup-options-terminal' },\n  title() {\n    return loc('enroll.title.oda.with.account', 'login');\n  },\n  initialize() {\n    BaseForm.prototype.initialize.apply(this, arguments);\n    const deviceEnrollmentContext = getDeviceEnrollmentContext(this.options.appState.get('deviceEnrollment'));\n    this.model.set('hasOVAccount', 'no');\n    this.addInput({\n      label: () => loc('enroll.subtitle.fastpass', 'login', [ deviceEnrollmentContext.orgName ]),\n      'label-top': true,\n      options: {\n        'no': loc('enroll.option.noaccount.fastpass', 'login'),\n        'yes': loc('enroll.option.account.fastpass', 'login'),\n      },\n      name: 'hasOVAccount',\n      type: 'radio',\n    });\n  },\n\n  saveForm() {\n    //remove any existing warnings or messages before saving form\n    this.$el.find('.o-form-error-container').empty();\n    this.options.appState.trigger('updateDeviceEnrollmentView', this.model.get('hasOVAccount') === 'yes');\n  }\n});\n\nconst AndroidAppLinkWithAccountOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'android-oda-app-link-with-ov-account-terminal' },\n  title() {\n    return loc('enroll.title.oda.with.account', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(AndroidAppLinkWithAccountOdaTerminalView);\n  },\n});\n\nconst AndroidAppLinkWithoutAccountOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'android-oda-app-link-without-ov-account-terminal' },\n  title() {\n    return loc('enroll.title.oda.without.account', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(AndroidAppLinkWithoutAccountOdaTerminalView);\n  },\n});\n\nconst IosAndAndroidLoopbackOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'loopback-terminal' },\n  title() {\n    return loc('enroll.title.oda', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(IosAndAndroidLoopbackOdaTerminalView);\n  },\n});\n\nconst MdmTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'mdm-terminal' },\n  title() {\n    return loc('enroll.title.mdm', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(MdmOktaVerifyTerminalView);\n  },\n});\n\nconst AndroidAppLinkTerminalViewFooter = Link.extend({\n  postRender() {\n    this.$el.click((event) => {\n      event.preventDefault();\n      this.options.appState.trigger('switchBackToPreselect');\n    });\n  }\n});\n\nexport default BaseView.extend({\n  initialize() {\n    BaseView.prototype.initialize.apply(this, arguments);\n    this.listenTo(this.options.appState, 'updateDeviceEnrollmentView', this.handleUpdateDeviceEnrollmentView);\n    this.listenTo(this.options.appState, 'switchBackToPreselect', this.handleSwitchBackToPreselect);\n\n    const deviceEnrollmentContext = getDeviceEnrollmentContext(this.options.appState.get('deviceEnrollment'));\n    this.enrollmentType = (deviceEnrollmentContext.enrollmentType|| '').toLowerCase(); // oda/mdm\n\n    switch (this.enrollmentType) {\n    case Enums.ODA:\n      this.Header = OktaVerifyAuthenticatorHeader;\n      this.Body = deviceEnrollmentContext.isAndroidAppLink ?\n        AndroidAppLinkPreselectForm : IosAndAndroidLoopbackOdaTerminalForm;\n      break;\n    case Enums.MDM:\n      this.Body = MdmTerminalForm;\n      break;\n    case Enums.WS1:\n      this.Body = MdmTerminalForm;\n    }\n  },\n\n  handleUpdateDeviceEnrollmentView(withAccount) {\n    this.Body = withAccount ? AndroidAppLinkWithAccountOdaTerminalForm : AndroidAppLinkWithoutAccountOdaTerminalForm;\n    this.backLink = this.add(AndroidAppLinkTerminalViewFooter, {\n      options: {\n        name: 'back-to-preselect',\n        label: loc('oform.back', 'login'),\n      }\n    }).last();\n    this.renderForm();\n  },\n\n  handleSwitchBackToPreselect() {\n    this.Body = AndroidAppLinkPreselectForm;\n    this.backLink && this.backLink.remove();\n    this.render();\n  },\n});\n"],"names":["BaseDeviceEnrollTerminalForm","BaseForm","extend","noButtonBar","className","AndroidAppLinkPreselectForm","attributes","title","loc","initialize","prototype","apply","arguments","deviceEnrollmentContext","getDeviceEnrollmentContext","options","appState","get","model","set","addInput","label","orgName","name","type","saveForm","$el","find","empty","trigger","AndroidAppLinkWithAccountOdaTerminalForm","add","AndroidAppLinkWithAccountOdaTerminalView","AndroidAppLinkWithoutAccountOdaTerminalForm","AndroidAppLinkWithoutAccountOdaTerminalView","IosAndAndroidLoopbackOdaTerminalForm","IosAndAndroidLoopbackOdaTerminalView","MdmTerminalForm","MdmOktaVerifyTerminalView","AndroidAppLinkTerminalViewFooter","Link","postRender","click","event","preventDefault","BaseView","listenTo","handleUpdateDeviceEnrollmentView","handleSwitchBackToPreselect","enrollmentType","toLowerCase","Enums","ODA","Header","OktaVerifyAuthenticatorHeader","Body","isAndroidAppLink","MDM","WS1","withAccount","backLink","last","renderForm","remove","render"],"mappings":"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"}