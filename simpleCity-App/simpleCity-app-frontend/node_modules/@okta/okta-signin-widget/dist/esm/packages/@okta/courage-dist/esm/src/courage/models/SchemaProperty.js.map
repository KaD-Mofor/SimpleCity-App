{"version":3,"file":"SchemaProperty.js","sources":["../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/models/SchemaProperty.js"],"sourcesContent":["import oktaJQueryStatic from '../util/jquery-wrapper.js';\nimport oktaUnderscore from '../util/underscore-wrapper.js';\nimport BaseCollection from './BaseCollection.js';\nimport BaseModel from './BaseModel.js';\nimport Logger from '../util/Logger.js';\nimport SchemaUtils from '../util/SchemaUtil.js';\nimport StringUtil from '../util/StringUtil.js';\nimport EnumTypeHelper from '../views/forms/helpers/EnumTypeHelper.js';\n\n/* eslint-disable @okta/okta/no-exclusive-language */\nconst loc = StringUtil.localize;\nconst STRING = SchemaUtils.STRING;\nconst NUMBER = SchemaUtils.NUMBER;\nconst INTEGER = SchemaUtils.INTEGER;\nconst OBJECT = SchemaUtils.OBJECT;\n\nconst getArrayTypeName = function (type, elementType) {\n  return type + 'of' + elementType;\n};\n\nconst SchemaPropertySubSchema = BaseModel.extend({\n  defaults: {\n    description: undefined,\n    minLength: undefined,\n    maxLength: undefined,\n    format: undefined\n  },\n  parse: function (resp) {\n    if (oktaUnderscore.isString(resp.format)) {\n      const matcher = /^\\/(.+)\\/$/.exec(resp.format);\n\n      if (matcher) {\n        resp.format = matcher[1];\n      }\n    }\n\n    return resp;\n  }\n});\nconst SchemaPropertySubSchemaCollection = BaseCollection.extend({\n  model: SchemaPropertySubSchema\n});\nconst SchemaPropertySubSchemaAllOfCollection = SchemaPropertySubSchemaCollection.extend({\n  _type: 'allOf'\n});\nconst SchemaPropertySubSchemaOneOfCollection = SchemaPropertySubSchemaCollection.extend({\n  _type: 'oneOf'\n});\nconst SchemaPropertySubSchemaNoneOfCollection = SchemaPropertySubSchemaCollection.extend({\n  _type: 'noneOf'\n});\nconst constraintTypeErrorMessages = {\n  string: loc('schema.validation.field.value.must.string', 'courage'),\n  number: loc('schema.validation.field.value.must.number', 'courage'),\n  integer: loc('schema.validation.field.value.must.integer', 'courage'),\n  object: loc('schema.validation.field.value.must.object', 'courage')\n};\nconst loginFormatNonePattern = '.+';\nconst escapedLoginCharsRe = /[^a-zA-Z0-9-]/;\nconst constraintHandlers = {\n  between: '_checkBetweenConstraints',\n  greaterThan: '_checkGreaterThanConstraint',\n  lessThan: '_checkLessThanConstraint',\n  equals: '_checkEqualsConstraint'\n};\nconst SchemaPropertySchemaProperty = BaseModel.extend({\n  idAttribute: 'name',\n  local: {\n    __oneOf__: {\n      type: 'array',\n      minItems: 1\n    }\n  },\n  defaults: {\n    // OKTA-28445, set empty string by default as the key for each property when syncing with server\n    // so that server can respond with error when a name is not provided\n    name: '',\n    title: undefined,\n    type: undefined,\n    description: undefined,\n    required: false,\n    format: undefined,\n    // choose disable option be default.\n    union: undefined,\n    subSchemas: undefined,\n    settings: {\n      permissions: {\n        SELF: SchemaUtils.PERMISSION.READ_ONLY\n      }\n    },\n    unique: undefined,\n    __metadata__: undefined,\n    __isSensitive__: BaseModel.ComputedProperty(['settings'], function (settings) {\n      return !!(settings && settings.sensitive && settings.sensitive !== 'NOT_SENSITIVE');\n    }),\n    __isPendingSensitive__: BaseModel.ComputedProperty(['settings'], function (settings) {\n      return !!(settings && settings.sensitive && settings.sensitive === 'PENDING_SENSITIVE');\n    }),\n    __unique__: false,\n    __isUniqueValidated__: BaseModel.ComputedProperty(['unique'], function (unique) {\n      return unique === SchemaUtils.UNIQUENESS.UNIQUE_VALIDATED;\n    }),\n    __isPendingUniqueness__: BaseModel.ComputedProperty(['unique'], function (unique) {\n      return unique === SchemaUtils.UNIQUENESS.PENDING_UNIQUENESS;\n    }),\n    __isUniqueness__: BaseModel.ComputedProperty(['__isUniqueValidated__', '__isPendingUniqueness__'], function (isValidated, isPending) {\n      return isValidated || isPending;\n    }),\n    __canBeSensitive__: BaseModel.ComputedProperty(['__metadata__'], function (metadata) {\n      return !!(metadata && metadata.sensitivizable);\n    }),\n    __userPermission__: SchemaUtils.PERMISSION.READ_ONLY,\n    __displayType__: undefined,\n    __displayTypeLabel__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return SchemaUtils.DATATYPE[displayType] || displayType;\n    }),\n    __supportsMinMax__: false,\n    // use the private naming convention for these computed properties,\n    // to deal with the complexity in cloning schema with properties (toJSON({verbose: true})),\n    // to make sure these attributes are being excluded from api request\n    __isReadOnly__: BaseModel.ComputedProperty(['mutability'], function (mutability) {\n      return mutability === SchemaUtils.MUTABILITY.READONLY;\n    }),\n    __isWriteOnly__: BaseModel.ComputedProperty(['mutability'], function (mutability) {\n      return mutability === SchemaUtils.MUTABILITY.WRITEONLY;\n    }),\n    __displayScope__: undefined,\n    __isScopeSelf__: BaseModel.ComputedProperty(['scope'], function (scope) {\n      return scope === SchemaUtils.SCOPE.SELF;\n    }),\n    __isNoneScopeArrayType__: BaseModel.ComputedProperty(['__isScopeSelf__', '__displayType__'], function (isScopeSelf, displayType) {\n      return !isScopeSelf && SchemaUtils.isArrayDataType(displayType);\n    }),\n    __isImported__: BaseModel.ComputedProperty(['externalName'], function (externalName) {\n      return !!externalName;\n    }),\n    __isFromBaseSchema__: BaseModel.ComputedProperty(['__schemaMeta__'], function (schemaMeta) {\n      return schemaMeta && schemaMeta.name === 'base';\n    }),\n    // Only UI can turn on __enumDefined__ and reprocess the enum/oneOf value; otherwise,\n    // it should leave existing value untouch\n    __enumDefined__: false,\n    __supportEnum__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return oktaUnderscore.contains(SchemaUtils.SUPPORTENUM, displayType);\n    }),\n    __isNumberTypeEnum__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return oktaUnderscore.contains([SchemaUtils.NUMBER, SchemaUtils.ARRAYDISPLAYTYPE.arrayofnumber], displayType);\n    }),\n    __isIntegerTypeEnum__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return oktaUnderscore.contains([SchemaUtils.INTEGER, SchemaUtils.ARRAYDISPLAYTYPE.arrayofinteger], displayType);\n    }),\n    __isObjectTypeEnum__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return oktaUnderscore.contains([SchemaUtils.OBJECT, SchemaUtils.ARRAYDISPLAYTYPE.arrayofobject], displayType);\n    }),\n    __isStringTypeEnum__: BaseModel.ComputedProperty(['__displayType__'], function (displayType) {\n      return oktaUnderscore.contains([SchemaUtils.STRING, SchemaUtils.ARRAYDISPLAYTYPE.arrayofstring], displayType);\n    }),\n    __enumConstraintType__: BaseModel.ComputedProperty(['__isStringTypeEnum__', '__isNumberTypeEnum__', '__isIntegerTypeEnum__', '__isObjectTypeEnum__'], function (isStringType, isNumberType, isIntegerType, isObjectType) {\n      if (isStringType) {\n        return STRING;\n      }\n\n      if (isNumberType) {\n        return NUMBER;\n      }\n\n      if (isIntegerType) {\n        return INTEGER;\n      }\n\n      if (isObjectType) {\n        return OBJECT;\n      }\n    }),\n    __isEnumDefinedAndSupported__: BaseModel.ComputedProperty(['__enumDefined__', '__supportEnum__'], function (enumDefined, supportEnum) {\n      return enumDefined && supportEnum;\n    }),\n    __isLoginOfBaseSchema__: BaseModel.ComputedProperty(['__isFromBaseSchema__', 'name'], function (isFromBaseSchema, name) {\n      return isFromBaseSchema && name === 'login';\n    }),\n    __isLoginFormatRestrictionToEmail__: BaseModel.ComputedProperty(['__loginFormatRestriction__'], function (loginFormatRestriction) {\n      return loginFormatRestriction === SchemaUtils.LOGINPATTERNFORMAT.EMAIL;\n    })\n  },\n  initialize: function () {\n    BaseModel.prototype.initialize.apply(this, arguments);\n    this.listenTo(this, 'change:__displayType__', this._updateTypeFormatConstraints);\n    this.listenTo(this, 'change:type change:format change:items', this._updateDisplayType);\n    this.listenTo(this, 'change:__minVal__ change:__maxVal__', this._updateMinMax);\n    this.listenTo(this, 'change:__equals__', this._convertEqualsToMinMax);\n    this.listenTo(this, 'change:__constraint__', this._setConstraintText);\n\n    this._setConstraintText();\n\n    this._setLoginPattern();\n  },\n  parse: function (resp) {\n    /* eslint complexity: [2, 9] */\n    resp = oktaUnderscore.clone(resp);\n\n    if (resp.type === 'object' && resp.extendedType === 'image') {\n      resp.type = 'image';\n    }\n\n    resp['__displayType__'] = SchemaUtils.getDisplayType(resp.type, resp.format, resp.items ? resp.items.format ? resp.items.format : resp.items.type : undefined);\n\n    this._setRangeConstraints(resp);\n\n    resp['__supportsMinMax__'] = SchemaUtils.SUPPORTSMINMAX.indexOf(resp['__displayType__']) !== -1;\n    resp['__displayScope__'] = SchemaUtils.DISPLAYSCOPE[resp.scope] || SchemaUtils.DISPLAYSCOPE.NA;\n\n    if (resp.settings && resp.settings.permissions && resp.settings.permissions.SELF) {\n      resp['__userPermission__'] = resp.settings.permissions.SELF;\n    }\n\n    this._setMasterOverride(resp);\n\n    this._setSubSchemas(resp);\n\n    this._setUniqueness(resp);\n\n    return resp;\n  },\n  validate: function () {\n    const enumValidationError = this._validateEnumOneOf();\n\n    if (enumValidationError) {\n      return enumValidationError;\n    }\n\n    if (!this.get('__supportsMinMax__') || !this.get('__constraint__')) {\n      return undefined;\n    }\n\n    const constraitType = this.get('__constraint__');\n    const constraitHandler = this[constraintHandlers[constraitType]];\n\n    if (oktaUnderscore.isFunction(constraitHandler)) {\n      return constraitHandler.call(this);\n    } else {\n      Logger.warn('No constraint handler found for: ' + constraitType);\n      return undefined;\n    }\n  },\n  _checkBetweenConstraints: function () {\n    const minVal = this.get('__minVal__');\n    const maxVal = this.get('__maxVal__');\n\n    if (!minVal && !maxVal) {\n      return;\n    }\n\n    if (!minVal) {\n      return {\n        __minVal__: 'Min value is required'\n      };\n    }\n\n    if (!maxVal) {\n      return {\n        __maxVal__: 'Max value is required'\n      };\n    }\n\n    let val = this._checkIntegerConstraints('__minVal__', 'Min value');\n\n    if (val) {\n      return val;\n    }\n\n    val = this._checkIntegerConstraints('__maxVal__', 'Max value');\n\n    if (val) {\n      return val;\n    }\n\n    if (+minVal >= +maxVal) {\n      return {\n        __maxVal__: 'Max val must be greater than min val'\n      };\n    }\n  },\n  _checkGreaterThanConstraint: function () {\n    const minVal = this.get('__minVal__');\n\n    if (!minVal) {\n      return;\n    }\n\n    const val = this._checkIntegerConstraints('__minVal__', 'Min value');\n\n    if (val) {\n      return val;\n    }\n  },\n  _checkLessThanConstraint: function () {\n    const maxVal = this.get('__maxVal__');\n\n    if (!maxVal) {\n      return;\n    }\n\n    const val = this._checkIntegerConstraints('__maxVal__', 'Max value');\n\n    if (val) {\n      return val;\n    }\n  },\n  _checkEqualsConstraint: function () {\n    const equals = this.get('__equals__');\n\n    if (!equals) {\n      return;\n    }\n\n    const val = this._checkIntegerConstraints('__equals__', 'Constraint');\n\n    if (val) {\n      return val;\n    }\n  },\n  _checkIntegerConstraints: function (field, name) {\n    const val = this.get(field);\n    const error = {}; // eslint-disable-next-line no-restricted-globals\n\n    if (isNaN(val)) {\n      error[field] = name + ' must be a number';\n      return error;\n    }\n\n    if (+val < 0) {\n      error[field] = name + ' must be greater than 0';\n      return error;\n    }\n  },\n  _setMasterOverride: function (resp) {\n    if (resp.settings && resp.settings.masterOverride && resp.settings.masterOverride) {\n      const masterOverrideValue = resp.settings.masterOverride.value;\n\n      if (oktaUnderscore.isArray(masterOverrideValue) && !oktaUnderscore.isEmpty(masterOverrideValue)) {\n        resp['__masterOverrideType__'] = 'OVERRIDE';\n        resp['__masterOverrideValue__'] = masterOverrideValue || [];\n      } else {\n        resp['__masterOverrideType__'] = resp.settings.masterOverride.type;\n      }\n    } else {\n      resp['__masterOverrideType__'] = 'INHERIT';\n    }\n  },\n  _setRangeConstraints: function (resp) {\n    /* eslint complexity: [2, 11] */\n    if (resp['__displayType__'] === STRING) {\n      resp['__minVal__'] = resp.minLength;\n      resp['__maxVal__'] = resp.maxLength;\n    } else if (resp['__displayType__'] === INTEGER || resp['__displayType__'] === NUMBER) {\n      resp['__minVal__'] = resp.minimum;\n      resp['__maxVal__'] = resp.maximum;\n    }\n\n    if (resp['__minVal__'] && resp['__maxVal__']) {\n      if (resp['__minVal__'] === resp['__maxVal__']) {\n        resp['__constraint__'] = 'equals';\n        resp['__equals__'] = resp['__minVal__'];\n      } else {\n        resp['__constraint__'] = 'between';\n      }\n    } else if (!resp['__minVal__'] && resp['__maxVal__']) {\n      resp['__constraint__'] = 'lessThan';\n    } else if (!resp['__maxVal__'] && resp['__minVal__']) {\n      resp['__constraint__'] = 'greaterThan';\n    }\n  },\n  _setSubSchemas: function (resp) {\n    if (resp.allOf) {\n      resp['subSchemas'] = new SchemaPropertySubSchemaAllOfCollection(resp.allOf, {\n        parse: true\n      });\n    } else if (resp.oneOf) {\n      resp['subSchemas'] = new SchemaPropertySubSchemaOneOfCollection(resp.oneOf, {\n        parse: true\n      });\n    } else if (resp.noneOf) {\n      resp['subSchemas'] = new SchemaPropertySubSchemaNoneOfCollection(resp.noneOf, {\n        parse: true\n      });\n    }\n  },\n  _setUniqueness: function (resp) {\n    const unique = resp && resp.unique;\n    resp['__unique__'] = !!(unique && (unique === SchemaUtils.UNIQUENESS.UNIQUE_VALIDATED || unique === SchemaUtils.UNIQUENESS.PENDING_UNIQUENESS));\n  },\n  _setLoginPattern: function () {\n    if (!this.get('__isLoginOfBaseSchema__')) {\n      return;\n    }\n\n    const pattern = this.get('pattern');\n\n    if (pattern === loginFormatNonePattern) {\n      this.set('__loginFormatRestriction__', SchemaUtils.LOGINPATTERNFORMAT.NONE);\n    } else if (pattern) {\n      this.set('__loginFormatRestriction__', SchemaUtils.LOGINPATTERNFORMAT.CUSTOM);\n      this.set('__loginFormatRestrictionCustom__', this._extractLoginPattern(pattern));\n    } else {\n      this.set('__loginFormatRestriction__', SchemaUtils.LOGINPATTERNFORMAT.EMAIL);\n    }\n  },\n  _updateDisplayType: function () {\n    const type = this.get('type');\n\n    if (type === STRING && this.get('format')) {\n      this.set('__displayType__', SchemaUtils.FORMATDISPLAYTYPE[this.get('format')]);\n    } else {\n      const items = this.get('items');\n      const arraytype = items && (items.format ? items.format : items.type);\n\n      if (type && arraytype) {\n        this.set('__displayType__', SchemaUtils.ARRAYDISPLAYTYPE[getArrayTypeName(type, arraytype)]);\n      } else {\n        this.set('__displayType__', type);\n      }\n    }\n  },\n  _validateEnumOneOf: function () {\n    if (!this.get('__isEnumDefinedAndSupported__')) {\n      return;\n    }\n\n    const enumOneOf = this.get('__oneOf__') || [];\n\n    if (oktaUnderscore.isEmpty(enumOneOf)) {\n      return {\n        __oneOf__: loc('model.validation.field.blank', 'courage')\n      };\n    }\n\n    if (!this._isValidateOneOfConstraint(enumOneOf)) {\n      const constraintType = this.get('__enumConstraintType__');\n      const errorTypeMsg = constraintTypeErrorMessages[constraintType];\n      return {\n        __oneOf__: errorTypeMsg\n      };\n    }\n  },\n  _isValidateOneOfConstraint: function (values) {\n    const constraintType = this.get('__enumConstraintType__');\n    return oktaUnderscore.all(values, function (value) {\n      return EnumTypeHelper.isConstraintValueMatchType(value.const, constraintType);\n    });\n  },\n  toJSON: function () {\n    let json = BaseModel.prototype.toJSON.apply(this, arguments);\n    json.settings = {\n      permissions: {}\n    };\n    json.settings.permissions['SELF'] = this.get('__userPermission__'); // omit \"sensitive\" filed will have default it value to false.\n\n    if (this.get('__isSensitive__')) {\n      json.settings.sensitive = this.get('__isSensitive__');\n    }\n\n    if (this.get('type') === 'image') {\n      json.type = 'object';\n      json.extendedType = 'image';\n    }\n\n    json = this._enumAssignment(json);\n    json = this._attributeOverrideToJson(json);\n    json = this._normalizeUnionValue(json);\n    json = this._patternAssignment(json);\n    json = this._uniquenessAssignment(json);\n    return json;\n  },\n  _attributeOverrideToJson: function (json) {\n    const masterOverrideType = this.get('__masterOverrideType__');\n    const masterOverrideValue = this.get('__masterOverrideValue__');\n\n    if (masterOverrideType === 'OKTA_MASTERED') {\n      json.settings.masterOverride = {\n        type: 'OKTA_MASTERED'\n      };\n    } else if (masterOverrideType === 'OVERRIDE') {\n      json.settings.masterOverride = {\n        type: 'ORDERED_LIST',\n        value: []\n      };\n\n      if (masterOverrideValue instanceof BaseCollection) {\n        oktaUnderscore.each(masterOverrideValue.toJSON(), function (overrideProfile) {\n          json.settings.masterOverride.value.push(overrideProfile.id);\n        });\n      } else if (masterOverrideValue instanceof Array) {\n        json.settings.masterOverride.value = masterOverrideValue;\n      }\n\n      if (oktaUnderscore.isEmpty(json.settings.masterOverride.value)) {\n        delete json.settings.masterOverride;\n      }\n    }\n\n    if (masterOverrideType === 'INHERIT') {\n      delete json.settings.masterOverride;\n    }\n\n    return json;\n  },\n\n  /**\n   * Only allow set \"union\" value when isScopeSelf is NONE and displayType is\n   * array of (string/number/integer), otherwise reset to default.\n   *\n   * @see /universal-directory/shared/views/components/UnionGroupValuesRadio.js\n   */\n  _normalizeUnionValue: function (json) {\n    if (!this.get('__isNoneScopeArrayType__')) {\n      json['union'] = undefined;\n    }\n\n    return json;\n  },\n  _enumAssignment: function (json) {\n    if (!this.get('__isEnumDefinedAndSupported__')) {\n      return json;\n    } // backfill empty title by constraint\n\n\n    const enumOneOf = this._getEnumOneOfWithTitleCheck();\n\n    if (this.get('type') === 'array') {\n      delete json.items.enum;\n      json.items.oneOf = enumOneOf;\n    } else {\n      delete json.enum;\n      json.oneOf = enumOneOf;\n    }\n\n    return json;\n  },\n  _patternAssignment: function (json) {\n    if (!this.get('__isLoginOfBaseSchema__') || !this.get('__loginFormatRestriction__')) {\n      return json;\n    }\n\n    switch (this.get('__loginFormatRestriction__')) {\n      case SchemaUtils.LOGINPATTERNFORMAT.EMAIL:\n        delete json.pattern;\n        break;\n\n      case SchemaUtils.LOGINPATTERNFORMAT.CUSTOM:\n        json.pattern = this._buildLoginPattern(this.get('__loginFormatRestrictionCustom__'));\n        break;\n\n      case SchemaUtils.LOGINPATTERNFORMAT.NONE:\n        json.pattern = loginFormatNonePattern;\n        break;\n    }\n\n    return json;\n  },\n  _uniquenessAssignment: function (json) {\n    if (!this.get('__unique__')) {\n      delete json.unique;\n    } else if (!this.get('__isUniqueness__')) {\n      json.unique = SchemaUtils.UNIQUENESS.UNIQUE_VALIDATED;\n    }\n\n    return json;\n  },\n\n  /**\n   * Character should be escaped except letters, digits and hyphen\n   */\n  _escapedRegexChar: function (pattern, index) {\n    const char = pattern.charAt(index);\n\n    if (escapedLoginCharsRe.test(char)) {\n      return '\\\\' + char;\n    }\n\n    return char;\n  },\n  _buildLoginPattern: function (pattern) {\n    let result = '';\n\n    for (var i = 0; i < pattern.length; i++) {\n      result += this._escapedRegexChar(pattern, i);\n    }\n\n    return '[' + result + ']+';\n  },\n  _extractLoginPattern: function (pattern) {\n    const re = /^\\[(.*)\\]\\+/;\n    const matches = pattern.match(re);\n    return matches ? matches[1].replace(/\\\\(.)/g, '$1') : pattern;\n  },\n  _getEnumOneOfWithTitleCheck: function () {\n    const enumOneOf = this.get('__oneOf__');\n    return oktaUnderscore.map(enumOneOf, function (value) {\n      if (oktaJQueryStatic.trim(value.title) !== '') {\n        return value;\n      }\n\n      value.title = !oktaUnderscore.isString(value.const) ? JSON.stringify(value.const) : value.const;\n      return value;\n    });\n  },\n  _updateTypeFormatConstraints: function () {\n    const displayType = this.get('__displayType__'); // OKTA-31952 reset format according to its displayType\n\n    this.unset('format', {\n      silent: true\n    });\n    this.unset('items', {\n      silent: true\n    });\n    this.set(SchemaUtils.DISPLAYTYPES[displayType]);\n\n    if (displayType !== NUMBER && displayType !== INTEGER) {\n      this.unset('minimum');\n      this.unset('maximum');\n    }\n\n    if (displayType !== STRING) {\n      this.unset('minLength');\n      this.unset('maxLength');\n    }\n\n    this.unset('__minVal__');\n    this.unset('__maxVal__');\n    this.unset('__equals__');\n    this.set('__supportsMinMax__', SchemaUtils.SUPPORTSMINMAX.indexOf(this.get('__displayType__')) !== -1);\n  },\n  _updateMinMax: function () {\n    let min;\n    let max;\n    const displayType = this.get('__displayType__');\n\n    if (displayType === STRING) {\n      min = 'minLength';\n      max = 'maxLength';\n    } else if (displayType === INTEGER || displayType === NUMBER) {\n      min = 'minimum';\n      max = 'maximum';\n    }\n\n    if (this.get('__minVal__')) {\n      this.set(min, parseInt(this.get('__minVal__'), 10));\n    } else {\n      this.unset(min);\n    }\n\n    if (this.get('__maxVal__')) {\n      this.set(max, parseInt(this.get('__maxVal__'), 10));\n    } else {\n      this.unset(max);\n    }\n  },\n  _convertEqualsToMinMax: function () {\n    const equals = this.get('__equals__');\n\n    if (equals) {\n      this.set('__minVal__', equals);\n      this.set('__maxVal__', equals);\n    }\n  },\n\n  /*\n   Normally we would use a derived property here but derived properties do not work with the model Clone function\n   so we use this workaround instead.\n   */\n  _setConstraintText: function () {\n    const constraint = this.get('__constraint__');\n    const min = this.get('__minVal__');\n    const max = this.get('__maxVal__');\n    const equals = this.get('__equals__');\n\n    switch (constraint) {\n      case 'between':\n        this.set('__constraintText__', 'Between ' + min + ' and ' + max);\n        break;\n\n      case 'greaterThan':\n        this.set('__constraintText__', 'Greater than ' + min);\n        break;\n\n      case 'lessThan':\n        this.set('__constraintText__', 'Less than ' + max);\n        break;\n\n      case 'equals':\n        this.set('__constraintText__', 'Equals ' + equals);\n        break;\n\n      default:\n        this.set('__constraintText__', '');\n        break;\n    }\n  },\n  cleanup: function () {\n    if (this.get('__constraint__') === 'lessThan') {\n      this.unset('__minVal__');\n    } else if (this.get('__constraint__') === 'greaterThan') {\n      this.unset('__maxVal__');\n    }\n\n    if (this.get('scope') !== SchemaUtils.SCOPE.SYSTEM) {\n      if (this.get('__isScopeSelf__') === true) {\n        this.set({\n          scope: SchemaUtils.SCOPE.SELF\n        }, {\n          silent: true\n        });\n      } else {\n        this.unset('scope');\n      }\n    }\n\n    if (!this.get('__unique__')) {\n      this.unset('unique');\n    }\n  },\n\n  /**\n   * Since there is not an dedicated attribute to flag enum type,\n   * use enum values to determine whether the property is enum type or not.\n   */\n  isEnumType: function () {\n    return !!this.getEnumValues();\n  },\n  getEnumValues: function () {\n    return this.get('oneOf') || this.get('enum') || this.get('items') && this.get('items')['oneOf'] || this.get('items') && this.get('items')['enum'];\n  },\n  detectHasEnumDefined: function () {\n    const enumValues = this.getEnumValues();\n\n    if (!enumValues) {\n      return;\n    }\n\n    this.set('__oneOf__', EnumTypeHelper.convertToOneOf(enumValues));\n    this.set('__enumDefined__', true);\n  }\n});\nconst SchemaPropertySchemaProperties = BaseCollection.extend({\n  model: SchemaPropertySchemaProperty,\n  clone: function () {\n    return new this.constructor(this.toJSON({\n      verbose: true\n    }), {\n      parse: true\n    });\n  },\n  areAllReadOnly: function () {\n    return oktaUnderscore.all(this.pluck('__isReadOnly__'));\n  },\n  createModelProperties: function () {\n    return this.reduce(function (p, schemaProperty) {\n      const type = schemaProperty.get('type');\n      p[schemaProperty.id] = oktaUnderscore.clone(SchemaUtils.DISPLAYTYPES[type]);\n\n      if (SchemaUtils.SUPPORTSMINMAX.indexOf(type) !== -1) {\n        p[schemaProperty.id].minLength = schemaProperty.get('minLength');\n        p[schemaProperty.id].maxLength = schemaProperty.get('maxLength');\n      }\n\n      if (type === 'string') {\n        p[schemaProperty.id].format = schemaProperty.get('format');\n      }\n\n      return p;\n    }, {});\n  }\n});\nvar SchemaProperty = {\n  Model: SchemaPropertySchemaProperty,\n  Collection: SchemaPropertySchemaProperties\n};\n\nexport { SchemaProperty as default };\n"],"names":["loc","StringUtil","localize","STRING","SchemaUtils","NUMBER","INTEGER","OBJECT","getArrayTypeName","type","elementType","SchemaPropertySubSchema","BaseModel","extend","defaults","description","undefined","minLength","maxLength","format","parse","resp","oktaUnderscore","isString","matcher","exec","SchemaPropertySubSchemaCollection","BaseCollection","model","SchemaPropertySubSchemaAllOfCollection","_type","SchemaPropertySubSchemaOneOfCollection","SchemaPropertySubSchemaNoneOfCollection","constraintTypeErrorMessages","string","number","integer","object","loginFormatNonePattern","escapedLoginCharsRe","constraintHandlers","between","greaterThan","lessThan","equals","SchemaPropertySchemaProperty","idAttribute","local","__oneOf__","minItems","name","title","required","union","subSchemas","settings","permissions","SELF","PERMISSION","READ_ONLY","unique","__metadata__","__isSensitive__","ComputedProperty","sensitive","__isPendingSensitive__","__unique__","__isUniqueValidated__","UNIQUENESS","UNIQUE_VALIDATED","__isPendingUniqueness__","PENDING_UNIQUENESS","__isUniqueness__","isValidated","isPending","__canBeSensitive__","metadata","sensitivizable","__userPermission__","__displayType__","__displayTypeLabel__","displayType","DATATYPE","__supportsMinMax__","__isReadOnly__","mutability","MUTABILITY","READONLY","__isWriteOnly__","WRITEONLY","__displayScope__","__isScopeSelf__","scope","SCOPE","__isNoneScopeArrayType__","isScopeSelf","isArrayDataType","__isImported__","externalName","__isFromBaseSchema__","schemaMeta","__enumDefined__","__supportEnum__","contains","SUPPORTENUM","__isNumberTypeEnum__","ARRAYDISPLAYTYPE","arrayofnumber","__isIntegerTypeEnum__","arrayofinteger","__isObjectTypeEnum__","arrayofobject","__isStringTypeEnum__","arrayofstring","__enumConstraintType__","isStringType","isNumberType","isIntegerType","isObjectType","__isEnumDefinedAndSupported__","enumDefined","supportEnum","__isLoginOfBaseSchema__","isFromBaseSchema","__isLoginFormatRestrictionToEmail__","loginFormatRestriction","LOGINPATTERNFORMAT","EMAIL","initialize","prototype","apply","arguments","listenTo","_updateTypeFormatConstraints","_updateDisplayType","_updateMinMax","_convertEqualsToMinMax","_setConstraintText","_setLoginPattern","clone","extendedType","getDisplayType","items","_setRangeConstraints","SUPPORTSMINMAX","indexOf","DISPLAYSCOPE","NA","_setMasterOverride","_setSubSchemas","_setUniqueness","validate","enumValidationError","_validateEnumOneOf","get","constraitType","constraitHandler","isFunction","call","Logger","warn","_checkBetweenConstraints","minVal","maxVal","__minVal__","__maxVal__","val","_checkIntegerConstraints","_checkGreaterThanConstraint","_checkLessThanConstraint","_checkEqualsConstraint","field","error","isNaN","masterOverride","masterOverrideValue","value","isArray","isEmpty","minimum","maximum","allOf","oneOf","noneOf","pattern","set","NONE","CUSTOM","_extractLoginPattern","FORMATDISPLAYTYPE","arraytype","enumOneOf","_isValidateOneOfConstraint","constraintType","errorTypeMsg","values","all","EnumTypeHelper","isConstraintValueMatchType","const","toJSON","json","_enumAssignment","_attributeOverrideToJson","_normalizeUnionValue","_patternAssignment","_uniquenessAssignment","masterOverrideType","each","overrideProfile","push","id","Array","_getEnumOneOfWithTitleCheck","enum","_buildLoginPattern","_escapedRegexChar","index","char","charAt","test","result","i","length","re","matches","match","replace","map","oktaJQueryStatic","trim","JSON","stringify","unset","silent","DISPLAYTYPES","min","max","parseInt","constraint","cleanup","SYSTEM","isEnumType","getEnumValues","detectHasEnumDefined","enumValues","convertToOneOf","SchemaPropertySchemaProperties","constructor","verbose","areAllReadOnly","pluck","createModelProperties","reduce","p","schemaProperty","SchemaProperty","Model","Collection"],"mappings":"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"}