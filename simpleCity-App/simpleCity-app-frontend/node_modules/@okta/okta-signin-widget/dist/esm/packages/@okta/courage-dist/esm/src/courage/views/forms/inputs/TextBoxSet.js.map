{"version":3,"file":"TextBoxSet.js","sources":["../../../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/views/forms/inputs/TextBoxSet.js"],"sourcesContent":["import _Handlebars2 from '../../../../../lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport oktaUnderscore from '../../../util/underscore-wrapper.js';\nimport SchemaUtils from '../../../util/SchemaUtil.js';\nimport BaseInput from '../BaseInput.js';\nimport DeletableBox from './DeletableBox.js';\n\nvar TextBoxSet = BaseInput.extend({\n  className: 'array-input',\n  template: _Handlebars2.template({\n    \"compiler\": [8, \">= 4.3.0\"],\n    \"main\": function (container, depth0, helpers, partials, data) {\n      var lookupProperty = container.lookupProperty || function (parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n\n        return undefined;\n      };\n\n      return \"<a href=\\\"#\\\" class=\\\"array-inputs-button link-button\\\">\" + container.escapeExpression((lookupProperty(helpers, \"i18n\") || depth0 && lookupProperty(depth0, \"i18n\") || container.hooks.helperMissing).call(depth0 != null ? depth0 : container.nullContext || {}, {\n        \"name\": \"i18n\",\n        \"hash\": {\n          \"bundle\": \"courage\",\n          \"code\": \"oform.add.another\"\n        },\n        \"data\": data,\n        \"loc\": {\n          \"start\": {\n            \"line\": 1,\n            \"column\": 52\n          },\n          \"end\": {\n            \"line\": 1,\n            \"column\": 102\n          }\n        }\n      })) + \"</a>\";\n    },\n    \"useData\": true\n  }),\n  params: {\n    itemType: 'string'\n  },\n  events: {\n    'click .array-inputs-button': function (e) {\n      e.preventDefault();\n\n      if (this.isEditMode()) {\n        this.addNewElement();\n      }\n    }\n  },\n  initialize: function (options) {\n    options || (options = {});\n    this.params = oktaUnderscore.defaults(options.params || {}, this.params);\n    this.uniqueIdPrefix = 'array';\n  },\n  // api returns null for an array that does not have value\n  // convert it to an empty array\n  from: function (val) {\n    if (!oktaUnderscore.isArray(val)) {\n      return [];\n    }\n\n    return val;\n  },\n  // @Override\n  editMode: function () {\n    this._setArrayObject();\n\n    this.$el.html(this.template);\n\n    oktaUnderscore.each(this.arrayObject, oktaUnderscore.bind(this._addDeletableBox, this));\n\n    return this;\n  },\n  // @Override\n  readMode: function () {\n    this.editMode();\n    this.$('.array-inputs-button').addClass('link-button-disabled');\n  },\n  // @Override\n  // converts arrayObject to a plain array\n  // for string type array, returns all values\n  // for number/integer type array, returns values in number type\n  val: function () {\n    let values = oktaUnderscore.values(this.arrayObject);\n\n    if (oktaUnderscore.contains([SchemaUtils.DATATYPE.number, SchemaUtils.DATATYPE.integer], this.params.itemType)) {\n      values = oktaUnderscore.filter(values, oktaUnderscore.isNumber);\n    }\n\n    return values;\n  },\n  focus: function () {},\n  addNewElement: function () {\n    const value = '';\n\n    const key = oktaUnderscore.uniqueId(this.uniqueIdPrefix);\n\n    this.arrayObject[key] = value;\n\n    this._addDeletableBox(value, key); // update is called to make sure an empty string value is added for string type array\n\n\n    this.update();\n  },\n  _addDeletableBox: function (value, key) {\n    const deletableBox = new DeletableBox(oktaUnderscore.extend(oktaUnderscore.pick(this.options, 'read', 'readOnly', 'model'), {\n      key: key,\n      value: value,\n      itemType: this.params.itemType\n    }));\n    this.listenTo(deletableBox, 'updateArray', function (updatedValue) {\n      if (oktaUnderscore.isNull(updatedValue)) {\n        delete this.arrayObject[key];\n        this.stopListening(deletableBox);\n      } else {\n        this.arrayObject[key] = updatedValue;\n      }\n\n      this.update();\n    });\n    deletableBox.render().$el.hide();\n    this.$('.array-inputs-button').before(deletableBox.el);\n    deletableBox.$el.slideDown();\n    return deletableBox;\n  },\n  _setArrayObject: function () {\n    const array = this.model.get(this.options.name);\n    this.arrayObject = {};\n\n    if (oktaUnderscore.isArray(array) && !oktaUnderscore.isEmpty(array)) {\n      const keys = [];\n      const self = this;\n\n      oktaUnderscore(array.length).times(function () {\n        keys.push(oktaUnderscore.uniqueId(self.uniqueIdPrefix));\n      });\n\n      this.arrayObject = oktaUnderscore.object(keys, array);\n    }\n  }\n});\n\nexport { TextBoxSet as default };\n"],"names":["TextBoxSet","BaseInput","extend","className","template","_Handlebars2","container","depth0","helpers","partials","data","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","escapeExpression","hooks","helperMissing","nullContext","params","itemType","events","e","preventDefault","isEditMode","addNewElement","initialize","options","oktaUnderscore","defaults","uniqueIdPrefix","from","val","isArray","editMode","_setArrayObject","$el","html","each","arrayObject","bind","_addDeletableBox","readMode","$","addClass","values","contains","SchemaUtils","DATATYPE","number","integer","filter","isNumber","focus","value","key","uniqueId","update","deletableBox","DeletableBox","pick","listenTo","updatedValue","isNull","stopListening","render","hide","before","el","slideDown","array","model","get","name","isEmpty","keys","self","length","times","push","object"],"mappings":"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"}