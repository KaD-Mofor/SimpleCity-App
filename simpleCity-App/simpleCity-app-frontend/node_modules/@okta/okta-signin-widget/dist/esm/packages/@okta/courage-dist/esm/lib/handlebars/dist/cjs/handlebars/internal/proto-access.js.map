{"version":3,"file":"proto-access.js","sources":["../../../../../../../../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars/internal/proto-access.js"],"sourcesContent":["import { __exports as protoAccess } from '../../../../../../_virtual/proto-access.js';\nexport { __exports as default } from '../../../../../../_virtual/proto-access.js';\nimport './create-new-lookup-object.js';\nimport '../logger.js';\nimport { __exports as createNewLookupObject } from '../../../../../../_virtual/create-new-lookup-object.js';\nimport { l as logger$1 } from '../../../../../../_virtual/logger.js';\n\nprotoAccess.__esModule = true;\nprotoAccess.createProtoAccessControl = createProtoAccessControl;\nprotoAccess.resultIsAllowed = resultIsAllowed;\nprotoAccess.resetLoggedProperties = resetLoggedProperties; // istanbul ignore next\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj['default'] = obj;\n    return newObj;\n  }\n}\n\nvar _createNewLookupObject = createNewLookupObject;\n\nvar _logger = logger$1.exports;\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar loggedProperties = Object.create(null);\n\nfunction createProtoAccessControl(runtimeOptions) {\n  var defaultMethodWhiteList = Object.create(null);\n  defaultMethodWhiteList['constructor'] = false;\n  defaultMethodWhiteList['__defineGetter__'] = false;\n  defaultMethodWhiteList['__defineSetter__'] = false;\n  defaultMethodWhiteList['__lookupGetter__'] = false;\n  var defaultPropertyWhiteList = Object.create(null); // eslint-disable-next-line no-proto\n\n  defaultPropertyWhiteList['__proto__'] = false;\n  return {\n    properties: {\n      whitelist: _createNewLookupObject.createNewLookupObject(defaultPropertyWhiteList, runtimeOptions.allowedProtoProperties),\n      defaultValue: runtimeOptions.allowProtoPropertiesByDefault\n    },\n    methods: {\n      whitelist: _createNewLookupObject.createNewLookupObject(defaultMethodWhiteList, runtimeOptions.allowedProtoMethods),\n      defaultValue: runtimeOptions.allowProtoMethodsByDefault\n    }\n  };\n}\n\nfunction resultIsAllowed(result, protoAccessControl, propertyName) {\n  if (typeof result === 'function') {\n    return checkWhiteList(protoAccessControl.methods, propertyName);\n  } else {\n    return checkWhiteList(protoAccessControl.properties, propertyName);\n  }\n}\n\nfunction checkWhiteList(protoAccessControlForType, propertyName) {\n  if (protoAccessControlForType.whitelist[propertyName] !== undefined) {\n    return protoAccessControlForType.whitelist[propertyName] === true;\n  }\n\n  if (protoAccessControlForType.defaultValue !== undefined) {\n    return protoAccessControlForType.defaultValue;\n  }\n\n  logUnexpecedPropertyAccessOnce(propertyName);\n  return false;\n}\n\nfunction logUnexpecedPropertyAccessOnce(propertyName) {\n  if (loggedProperties[propertyName] !== true) {\n    loggedProperties[propertyName] = true;\n    logger.log('error', 'Handlebars: Access has been denied to resolve the property \"' + propertyName + '\" because it is not an \"own property\" of its parent.\\n' + 'You can add a runtime option to disable the check or this warning:\\n' + 'See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details');\n  }\n}\n\nfunction resetLoggedProperties() {\n  Object.keys(loggedProperties).forEach(function (propertyName) {\n    delete loggedProperties[propertyName];\n  });\n}\n"],"names":["protoAccess","__esModule","createProtoAccessControl","resultIsAllowed","resetLoggedProperties","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_createNewLookupObject","createNewLookupObject","_logger","logger$1","exports","logger","loggedProperties","create","runtimeOptions","defaultMethodWhiteList","defaultPropertyWhiteList","properties","whitelist","allowedProtoProperties","defaultValue","allowProtoPropertiesByDefault","methods","allowedProtoMethods","allowProtoMethodsByDefault","result","protoAccessControl","propertyName","checkWhiteList","protoAccessControlForType","undefined","logUnexpecedPropertyAccessOnce","log","keys","forEach"],"mappings":"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"}