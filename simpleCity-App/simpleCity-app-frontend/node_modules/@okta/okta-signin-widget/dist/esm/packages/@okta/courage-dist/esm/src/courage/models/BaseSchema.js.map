{"version":3,"file":"BaseSchema.js","sources":["../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseSchema.js"],"sourcesContent":["import oktaUnderscore from '../util/underscore-wrapper.js';\nimport BaseCollection from './BaseCollection.js';\nimport BaseModel from './BaseModel.js';\nimport SchemaProperty from './SchemaProperty.js';\n\nconst parseProperties = function (resp) {\n  const schemaMeta = oktaUnderscore.pick(resp, 'id', 'name', 'displayName');\n\n  const properties = oktaUnderscore.map(resp.schema.properties, function (property, name) {\n    return oktaUnderscore.extend({\n      name: name\n    }, property);\n  });\n\n  oktaUnderscore.each(properties, function (property) {\n    property['__schemaMeta__'] = schemaMeta;\n\n    if (property.__metadata) {\n      property['__metadata__'] = property.__metadata;\n      delete property.__metadata;\n    }\n  });\n\n  return properties;\n};\n\nconst BaseSchemaSchema = BaseModel.extend({\n  defaults: {\n    id: undefined,\n    displayName: undefined,\n    name: undefined\n  },\n  constructor: function () {\n    this.properties = new SchemaProperty.Collection();\n    BaseModel.apply(this, arguments);\n  },\n  getProperties: function () {\n    return this.properties;\n  },\n  clone: function () {\n    const model = BaseModel.prototype.clone.apply(this, arguments);\n    model.getProperties().set(this.getProperties().toJSON({\n      verbose: true\n    }));\n    return model;\n  },\n  parse: function (resp) {\n    const properties = parseProperties(resp);\n    this.properties.set(properties, {\n      parse: true\n    });\n    return oktaUnderscore.omit(resp, 'schema');\n  },\n  trimProperty: function (property) {\n    return oktaUnderscore.omit(property, 'name');\n  },\n  toJSON: function () {\n    const json = BaseModel.prototype.toJSON.apply(this, arguments);\n    json.schema = {\n      properties: {}\n    };\n    this.getProperties().each(function (model) {\n      const property = model.toJSON();\n      json.schema.properties[property.name] = this.trimProperty(property);\n    }, this);\n    return json;\n  },\n  save: function () {\n    this.getProperties().each(function (model) {\n      model.cleanup();\n    });\n    return BaseModel.prototype.save.apply(this, arguments);\n  }\n});\nconst BaseSchemaSchemas = BaseCollection.extend({\n  model: BaseSchemaSchema\n});\nvar BaseSchema = {\n  parseProperties: parseProperties,\n  Model: BaseSchemaSchema,\n  Collection: BaseSchemaSchemas\n};\n\nexport { BaseSchema as default };\n"],"names":["parseProperties","resp","schemaMeta","oktaUnderscore","pick","properties","map","schema","property","name","extend","each","__metadata","BaseSchemaSchema","BaseModel","defaults","id","undefined","displayName","constructor","SchemaProperty","Collection","apply","arguments","getProperties","clone","model","prototype","set","toJSON","verbose","parse","omit","trimProperty","json","save","cleanup","BaseSchemaSchemas","BaseCollection","BaseSchema","Model"],"mappings":"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"}