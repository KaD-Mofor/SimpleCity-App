{"version":3,"file":"flattenEmbedded.js","names":["flattenEmbedded","sdk","tx","res","obj","ref","clone","Array","isArray","objArr","o","ol","length","push","embedded","_embedded","key","Object","prototype","hasOwnProperty","call","isObject","fns","links2fns","assign","omit"],"sources":["../../../../lib/authn/util/flattenEmbedded.ts"],"sourcesContent":["/* eslint-disable complexity */\nimport { OktaAuthHttpInterface } from '../../http/types';\nimport { clone, isObject, omit } from '../../util';\nimport { AuthnTransactionAPI } from '../types';\nimport { links2fns } from './links2fns';\n\nexport function flattenEmbedded(sdk: OktaAuthHttpInterface, tx: AuthnTransactionAPI, res, obj, ref) {\n  obj = obj || res;\n  obj = clone(obj);\n\n  if (Array.isArray(obj)) {\n    var objArr = [];\n    for (var o = 0, ol = obj.length; o < ol; o++) {\n      objArr.push(flattenEmbedded(sdk, tx, res, obj[o], ref) as never);\n    }\n    return objArr;\n  }\n\n  var embedded = obj._embedded || {};\n\n  for (var key in embedded) {\n    if (!Object.prototype.hasOwnProperty.call(embedded, key)) {\n      continue;\n    }\n\n    // Flatten any nested _embedded objects\n    if (isObject(embedded[key]) || Array.isArray(embedded[key])) {\n      embedded[key] = flattenEmbedded(sdk, tx, res, embedded[key], ref);\n    }\n  }\n\n  // Convert any links on the embedded object\n  var fns = links2fns(sdk, tx, res, obj, ref);\n  Object.assign(embedded, fns);\n\n  obj = omit(obj, '_embedded', '_links');\n  Object.assign(obj, embedded);\n  return obj;\n}\n"],"mappings":";;;;AAEA;;AAEA;;AAJA;AAMO,SAASA,eAAT,CAAyBC,GAAzB,EAAqDC,EAArD,EAA8EC,GAA9E,EAAmFC,GAAnF,EAAwFC,GAAxF,EAA6F;EAClGD,GAAG,GAAGA,GAAG,IAAID,GAAb;EACAC,GAAG,GAAG,IAAAE,WAAA,EAAMF,GAAN,CAAN;;EAEA,IAAIG,KAAK,CAACC,OAAN,CAAcJ,GAAd,CAAJ,EAAwB;IACtB,IAAIK,MAAM,GAAG,EAAb;;IACA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGP,GAAG,CAACQ,MAAzB,EAAiCF,CAAC,GAAGC,EAArC,EAAyCD,CAAC,EAA1C,EAA8C;MAC5CD,MAAM,CAACI,IAAP,CAAYb,eAAe,CAACC,GAAD,EAAMC,EAAN,EAAUC,GAAV,EAAeC,GAAG,CAACM,CAAD,CAAlB,EAAuBL,GAAvB,CAA3B;IACD;;IACD,OAAOI,MAAP;EACD;;EAED,IAAIK,QAAQ,GAAGV,GAAG,CAACW,SAAJ,IAAiB,EAAhC;;EAEA,KAAK,IAAIC,GAAT,IAAgBF,QAAhB,EAA0B;IACxB,IAAI,CAACG,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCN,QAArC,EAA+CE,GAA/C,CAAL,EAA0D;MACxD;IACD,CAHuB,CAKxB;;;IACA,IAAI,IAAAK,cAAA,EAASP,QAAQ,CAACE,GAAD,CAAjB,KAA2BT,KAAK,CAACC,OAAN,CAAcM,QAAQ,CAACE,GAAD,CAAtB,CAA/B,EAA6D;MAC3DF,QAAQ,CAACE,GAAD,CAAR,GAAgBhB,eAAe,CAACC,GAAD,EAAMC,EAAN,EAAUC,GAAV,EAAeW,QAAQ,CAACE,GAAD,CAAvB,EAA8BX,GAA9B,CAA/B;IACD;EACF,CAvBiG,CAyBlG;;;EACA,IAAIiB,GAAG,GAAG,IAAAC,oBAAA,EAAUtB,GAAV,EAAeC,EAAf,EAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,GAA7B,CAAV;EACAY,MAAM,CAACO,MAAP,CAAcV,QAAd,EAAwBQ,GAAxB;EAEAlB,GAAG,GAAG,IAAAqB,UAAA,EAAKrB,GAAL,EAAU,WAAV,EAAuB,QAAvB,CAAN;EACAa,MAAM,CAACO,MAAP,CAAcpB,GAAd,EAAmBU,QAAnB;EACA,OAAOV,GAAP;AACD"}