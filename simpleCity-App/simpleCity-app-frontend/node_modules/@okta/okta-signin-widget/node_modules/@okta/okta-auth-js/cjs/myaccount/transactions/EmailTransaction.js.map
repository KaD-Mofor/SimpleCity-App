{"version":3,"file":"EmailTransaction.js","names":["EmailTransaction","BaseTransaction","constructor","oktaAuth","options","accessToken","res","id","profile","roles","status","_links","get","fn","generateRequestFnFromLinks","methodName","links","transactionClassName","delete","challenge","poll","verify","payload"],"sources":["../../../../lib/myaccount/transactions/EmailTransaction.ts"],"sourcesContent":["import { EmailChallengeTransaction, EmailStatusTransaction } from '.';\nimport { EmailProfile, EmailRole, Status, VerificationPayload } from '../types';\nimport BaseTransaction from './Base';\nimport { generateRequestFnFromLinks } from '../request';\n\nexport default class EmailTransaction extends BaseTransaction {\n  id: string;\n  profile: EmailProfile;\n  roles: EmailRole[];\n  status: Status;\n\n  // eslint-disable-next-line no-use-before-define\n  get: () => Promise<EmailTransaction>;\n  delete: () => Promise<BaseTransaction>;\n  challenge: () => Promise<EmailChallengeTransaction>;\n  poll?: () => Promise<EmailStatusTransaction>;\n  verify?: (payload: VerificationPayload) => Promise<BaseTransaction>;\n\n  constructor(oktaAuth, options) {\n    super(oktaAuth, options);\n\n    const { accessToken, res } = options;\n    // assign required fields from res\n    const { id, profile, roles, status, _links } = res;\n    this.id = id;\n    this.profile = profile;\n    this.roles = roles;\n    this.status = status;\n\n    // assign transformed fns to transaction\n    this.get = async () => {\n      const fn = generateRequestFnFromLinks({ \n        oktaAuth, \n        accessToken, \n        methodName: 'get', \n        links: _links,\n        transactionClassName: 'EmailTransaction'\n      });\n      return await fn() as EmailTransaction;\n    };\n    this.delete = async () => {\n      const fn = generateRequestFnFromLinks({ \n        oktaAuth, \n        accessToken, \n        methodName: 'delete', \n        links: _links \n      });\n      return await fn() as BaseTransaction;\n    };\n    this.challenge = async () => {\n      const fn = generateRequestFnFromLinks({ \n        oktaAuth, \n        accessToken, \n        methodName: 'challenge', \n        links: _links,\n        transactionClassName: 'EmailChallengeTransaction'\n      });\n      return await fn() as EmailChallengeTransaction;\n    };\n    if (_links.poll) {\n      this.poll = async () => {\n        const fn = generateRequestFnFromLinks({ \n          oktaAuth, \n          accessToken, \n          methodName: 'poll', \n          links: _links,\n          transactionClassName: 'EmailStatusTransaction'\n        });\n        return await fn() as EmailStatusTransaction;\n      };\n    }\n    if (_links.verify) {\n      this.verify = async (payload: VerificationPayload) => {\n        const fn = generateRequestFnFromLinks({ \n          oktaAuth, \n          accessToken, \n          methodName: 'verify', \n          links: _links,\n        });\n        return await fn(payload) as BaseTransaction;\n      };\n    }\n  }\n}\n"],"mappings":";;;;;;AAEA;;AACA;;AAEe,MAAMA,gBAAN,SAA+BC,aAA/B,CAA+C;EAM5D;EAOAC,WAAW,CAACC,QAAD,EAAWC,OAAX,EAAoB;IAC7B,MAAMD,QAAN,EAAgBC,OAAhB;IAEA,MAAM;MAAEC,WAAF;MAAeC;IAAf,IAAuBF,OAA7B,CAH6B,CAI7B;;IACA,MAAM;MAAEG,EAAF;MAAMC,OAAN;MAAeC,KAAf;MAAsBC,MAAtB;MAA8BC;IAA9B,IAAyCL,GAA/C;IACA,KAAKC,EAAL,GAAUA,EAAV;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKC,KAAL,GAAaA,KAAb;IACA,KAAKC,MAAL,GAAcA,MAAd,CAT6B,CAW7B;;IACA,KAAKE,GAAL,GAAW,YAAY;MACrB,MAAMC,EAAE,GAAG,IAAAC,mCAAA,EAA2B;QACpCX,QADoC;QAEpCE,WAFoC;QAGpCU,UAAU,EAAE,KAHwB;QAIpCC,KAAK,EAAEL,MAJ6B;QAKpCM,oBAAoB,EAAE;MALc,CAA3B,CAAX;MAOA,OAAO,MAAMJ,EAAE,EAAf;IACD,CATD;;IAUA,KAAKK,MAAL,GAAc,YAAY;MACxB,MAAML,EAAE,GAAG,IAAAC,mCAAA,EAA2B;QACpCX,QADoC;QAEpCE,WAFoC;QAGpCU,UAAU,EAAE,QAHwB;QAIpCC,KAAK,EAAEL;MAJ6B,CAA3B,CAAX;MAMA,OAAO,MAAME,EAAE,EAAf;IACD,CARD;;IASA,KAAKM,SAAL,GAAiB,YAAY;MAC3B,MAAMN,EAAE,GAAG,IAAAC,mCAAA,EAA2B;QACpCX,QADoC;QAEpCE,WAFoC;QAGpCU,UAAU,EAAE,WAHwB;QAIpCC,KAAK,EAAEL,MAJ6B;QAKpCM,oBAAoB,EAAE;MALc,CAA3B,CAAX;MAOA,OAAO,MAAMJ,EAAE,EAAf;IACD,CATD;;IAUA,IAAIF,MAAM,CAACS,IAAX,EAAiB;MACf,KAAKA,IAAL,GAAY,YAAY;QACtB,MAAMP,EAAE,GAAG,IAAAC,mCAAA,EAA2B;UACpCX,QADoC;UAEpCE,WAFoC;UAGpCU,UAAU,EAAE,MAHwB;UAIpCC,KAAK,EAAEL,MAJ6B;UAKpCM,oBAAoB,EAAE;QALc,CAA3B,CAAX;QAOA,OAAO,MAAMJ,EAAE,EAAf;MACD,CATD;IAUD;;IACD,IAAIF,MAAM,CAACU,MAAX,EAAmB;MACjB,KAAKA,MAAL,GAAc,MAAOC,OAAP,IAAwC;QACpD,MAAMT,EAAE,GAAG,IAAAC,mCAAA,EAA2B;UACpCX,QADoC;UAEpCE,WAFoC;UAGpCU,UAAU,EAAE,QAHwB;UAIpCC,KAAK,EAAEL;QAJ6B,CAA3B,CAAX;QAMA,OAAO,MAAME,EAAE,CAACS,OAAD,CAAf;MACD,CARD;IASD;EACF;;AA7E2D"}