{"version":3,"file":"base64.js","names":["stringToBase64Url","str","b64","btoa","base64ToBase64Url","replace","base64UrlToBase64","b64u","base64UrlToString","length","AuthSdkError","utf8","atob","decodeURIComponent","escape","e","stringToBuffer","buffer","Uint8Array","i","charCodeAt","base64UrlDecode","base64UrlToBuffer","from","c","bufferToBase64Url","bin","reduce","s","byte","String","fromCharCode"],"sources":["../../../lib/crypto/base64.ts"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { AuthSdkError } from '../errors';\nimport { atob, btoa } from './webcrypto';\n\n// converts a string to base64 (url/filename safe variant)\nexport function stringToBase64Url(str) {\n  var b64 = btoa(str);\n  return base64ToBase64Url(b64);\n}\n\n// converts a standard base64-encoded string to a \"url/filename safe\" variant\nexport function base64ToBase64Url(b64) {\n  return b64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\n\n// converts a \"url/filename safe\" base64 string to a \"standard\" base64 string\nexport function base64UrlToBase64(b64u) {\n  return b64u.replace(/-/g, '+').replace(/_/g, '/');\n}\n\nexport function base64UrlToString(b64u) {\n  var b64 = base64UrlToBase64(b64u);\n  switch (b64.length % 4) {\n    case 0:\n      break;\n    case 2:\n      b64 += '==';\n      break;\n    case 3:\n      b64 += '=';\n      break;\n    default:\n      throw new AuthSdkError('Not a valid Base64Url');\n  }\n  var utf8 = atob(b64);\n  try {\n    return decodeURIComponent(escape(utf8));\n  } catch (e) {\n    return utf8;\n  }\n}\n\nexport function stringToBuffer(str) {\n  var buffer = new Uint8Array(str.length);\n  for (var i = 0; i < str.length; i++) {\n    buffer[i] = str.charCodeAt(i);\n  }\n  return buffer;\n}\n\nexport function base64UrlDecode(str) {\n  return atob(base64UrlToBase64(str));\n}\n\n// Converts base64 string to binary data view\nexport function base64UrlToBuffer(b64u) {\n  return Uint8Array.from(base64UrlDecode(b64u), (c: string) => c.charCodeAt(0));\n}\n\n// Converts an ArrayBuffer object that contains binary data to base64 encoded string\nexport function bufferToBase64Url(bin) {\n  return btoa(new Uint8Array(bin).reduce((s, byte) => s + String.fromCharCode(byte), ''));\n}\n\n\n"],"mappings":";;;;;;;;;;;AAYA;;AACA;;AAbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACO,SAASA,iBAAT,CAA2BC,GAA3B,EAAgC;EACrC,IAAIC,GAAG,GAAG,IAAAC,eAAA,EAAKF,GAAL,CAAV;EACA,OAAOG,iBAAiB,CAACF,GAAD,CAAxB;AACD,C,CAED;;;AACO,SAASE,iBAAT,CAA2BF,GAA3B,EAAgC;EACrC,OAAOA,GAAG,CAACG,OAAJ,CAAY,KAAZ,EAAmB,GAAnB,EAAwBA,OAAxB,CAAgC,KAAhC,EAAuC,GAAvC,EAA4CA,OAA5C,CAAoD,KAApD,EAA2D,EAA3D,CAAP;AACD,C,CAED;;;AACO,SAASC,iBAAT,CAA2BC,IAA3B,EAAiC;EACtC,OAAOA,IAAI,CAACF,OAAL,CAAa,IAAb,EAAmB,GAAnB,EAAwBA,OAAxB,CAAgC,IAAhC,EAAsC,GAAtC,CAAP;AACD;;AAEM,SAASG,iBAAT,CAA2BD,IAA3B,EAAiC;EACtC,IAAIL,GAAG,GAAGI,iBAAiB,CAACC,IAAD,CAA3B;;EACA,QAAQL,GAAG,CAACO,MAAJ,GAAa,CAArB;IACE,KAAK,CAAL;MACE;;IACF,KAAK,CAAL;MACEP,GAAG,IAAI,IAAP;MACA;;IACF,KAAK,CAAL;MACEA,GAAG,IAAI,GAAP;MACA;;IACF;MACE,MAAM,IAAIQ,oBAAJ,CAAiB,uBAAjB,CAAN;EAVJ;;EAYA,IAAIC,IAAI,GAAG,IAAAC,eAAA,EAAKV,GAAL,CAAX;;EACA,IAAI;IACF,OAAOW,kBAAkB,CAACC,MAAM,CAACH,IAAD,CAAP,CAAzB;EACD,CAFD,CAEE,OAAOI,CAAP,EAAU;IACV,OAAOJ,IAAP;EACD;AACF;;AAEM,SAASK,cAAT,CAAwBf,GAAxB,EAA6B;EAClC,IAAIgB,MAAM,GAAG,IAAIC,UAAJ,CAAejB,GAAG,CAACQ,MAAnB,CAAb;;EACA,KAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,GAAG,CAACQ,MAAxB,EAAgCU,CAAC,EAAjC,EAAqC;IACnCF,MAAM,CAACE,CAAD,CAAN,GAAYlB,GAAG,CAACmB,UAAJ,CAAeD,CAAf,CAAZ;EACD;;EACD,OAAOF,MAAP;AACD;;AAEM,SAASI,eAAT,CAAyBpB,GAAzB,EAA8B;EACnC,OAAO,IAAAW,eAAA,EAAKN,iBAAiB,CAACL,GAAD,CAAtB,CAAP;AACD,C,CAED;;;AACO,SAASqB,iBAAT,CAA2Bf,IAA3B,EAAiC;EACtC,OAAOW,UAAU,CAACK,IAAX,CAAgBF,eAAe,CAACd,IAAD,CAA/B,EAAwCiB,CAAD,IAAeA,CAAC,CAACJ,UAAF,CAAa,CAAb,CAAtD,CAAP;AACD,C,CAED;;;AACO,SAASK,iBAAT,CAA2BC,GAA3B,EAAgC;EACrC,OAAO,IAAAvB,eAAA,EAAK,IAAIe,UAAJ,CAAeQ,GAAf,EAAoBC,MAApB,CAA2B,CAACC,CAAD,EAAIC,IAAJ,KAAaD,CAAC,GAAGE,MAAM,CAACC,YAAP,CAAoBF,IAApB,CAA5C,EAAuE,EAAvE,CAAL,CAAP;AACD"}