{"version":3,"file":"mixin.js","names":["mixinSession","Base","OktaAuthSession","constructor","args","session","createSessionApi","closeSession","close","then","clearStorage","catch","e","name","errorCode"],"sources":["../../../lib/session/mixin.ts"],"sourcesContent":["import { OktaAuthHttpInterface, OktaAuthHttpOptions } from '../http/types';\nimport { OktaAuthConstructor } from '../base/types';\nimport { createSessionApi } from './factory';\nimport {\n  OktaAuthSessionInterface, SessionAPI,\n} from './types';\nimport { StorageManagerInterface } from '../storage/types';\n\nexport function mixinSession\n<\n  S extends StorageManagerInterface = StorageManagerInterface,\n  O extends OktaAuthHttpOptions = OktaAuthHttpOptions,\n  TBase extends OktaAuthConstructor<OktaAuthHttpInterface<S, O>>\n    = OktaAuthConstructor<OktaAuthHttpInterface<S, O>>\n>\n(Base: TBase): TBase & OktaAuthConstructor<OktaAuthSessionInterface<S, O>>\n{\n  return class OktaAuthSession extends Base implements OktaAuthSessionInterface<S, O>\n  {\n    session: SessionAPI;\n\n    constructor(...args: any[]) {\n      super(...args);\n\n      this.session = createSessionApi(this);\n    }\n\n    // Ends the current Okta SSO session without redirecting to Okta.\n    closeSession(): Promise<unknown> {\n      return this.session.close() // DELETE /api/v1/sessions/me\n      .then(async () => {\n        // Clear all local tokens\n        this.clearStorage();\n      })\n      .catch(function(e) {\n        if (e.name === 'AuthApiError' && e.errorCode === 'E0000007') {\n          // Session does not exist or has already been closed\n          return null;\n        }\n        throw e;\n      });\n    }\n  };\n}\n"],"mappings":";;;;AAEA;;AAMO,SAASA,YAAT,CAONC,IAPM,EAQP;EACE,OAAO,MAAMC,eAAN,SAA8BD,IAA9B,CACP;IAGEE,WAAW,CAAC,GAAGC,IAAJ,EAAiB;MAC1B,MAAM,GAAGA,IAAT;MAEA,KAAKC,OAAL,GAAe,IAAAC,yBAAA,EAAiB,IAAjB,CAAf;IACD,CAPH,CASE;;;IACAC,YAAY,GAAqB;MAC/B,OAAO,KAAKF,OAAL,CAAaG,KAAb,GAAqB;MAArB,CACNC,IADM,CACD,YAAY;QAChB;QACA,KAAKC,YAAL;MACD,CAJM,EAKNC,KALM,CAKA,UAASC,CAAT,EAAY;QACjB,IAAIA,CAAC,CAACC,IAAF,KAAW,cAAX,IAA6BD,CAAC,CAACE,SAAF,KAAgB,UAAjD,EAA6D;UAC3D;UACA,OAAO,IAAP;QACD;;QACD,MAAMF,CAAN;MACD,CAXM,CAAP;IAYD;;EAvBH,CADA;AA0BD"}